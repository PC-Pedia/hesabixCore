import{_ as T,a as r,S as g}from"./main-9b36f05f.js";import{r as k,a as b,o as u,s as x,e as t,d as a,aa as h,b as c,w as d,u as _,ab as C,t as n,A as S,c as y}from"./vendor-adef9cb4.js";const D={name:"buysellByCommodity",data:()=>({loading:k(!0),sumSelected:0,year:{},dateStart:"",dateEnd:"",sumTotal:0,sumMoneyTotal:0,commoditys:[],types:[{id:"buy",label:"خرید"},{id:"sell",label:"فروش"},{id:"rfbuy",label:"برگشت از خرید"},{id:"rfsell",label:"برگشت از فروش"},{id:"all",label:"همه موارد"}],selectedType:{},selectedCommodity:{},searchValue:"",loading:k(!0),items:[],itemsSelected:[],headers:[{text:"کد",value:"code"},{text:"حسابداری",value:"docCode"},{text:"نوع",value:"type"},{text:"شخص",value:"person"},{text:"تاریخ",value:"date"},{text:"تعداد",value:"count",sortable:!0},{text:"موجودی",value:"amountInc",sortable:!0},{text:"مبلغ فی",value:"priceOne",sortable:!0},{text:"مبلغ کل",value:"priceAll",sortable:!0}]}),methods:{searchCommodity(s,e){e(!0),r.post("/api/commodity/list/search",{search:s}).then(i=>{this.commoditys=i.data,e(!1)})},loadData(){r.post("/api/commodity/list/search").then(s=>{this.commoditys=s.data,this.commoditys.length!=0&&(this.selectedCommodity=this.commoditys[0]),this.selectedType=this.types[4],this.loading=!1}),r.post("/api/year/get").then(s=>{this.year=s.data,this.loading=!1})},filter(){this.loading=!0,this.itemsSelected=[],r.post("/api/report/commodity/buysell",{type:this.selectedType.id,commodity:this.selectedCommodity.code,dateStart:this.dateStart,dateEnd:this.dateEnd}).then(s=>{this.items=s.data;let e=0,i=0;this.sumTotal=0,this.items.forEach(o=>{o.type=="sell"?(e-=parseInt(o.count.replaceAll(",","")),i+=parseInt(o.priceAll.replaceAll(",",""))):o.type=="buy"&&(e+=parseInt(o.count.replaceAll(",","")),i+=parseInt(o.priceAll.replaceAll(",",""))),o.amountInc=this.$filters.formatNumber(e)}),this.sumTotal=e,this.sumMoneyTotal=i,this.loading=!1})},excellOutput(s=!0){s?r({method:"post",url:"/api/report/person/buysell/export/excel",responseType:"arraybuffer",data:{items:this.items}}).then(e=>{window.URL.createObjectURL(new Blob([e.data]));var i=window.URL.createObjectURL(new Blob([e.data])),o=document.createElement("a");o.href=i,o.setAttribute("download","buysell-report-list.xlsx"),document.body.appendChild(o),o.click()}):this.itemsSelected.length===0?g.fire({text:"هیچ آیتمی انتخاب نشده است.",icon:"info",confirmButtonText:"قبول"}):r({method:"post",url:"/api/report/person/buysell/export/excel",responseType:"arraybuffer",data:{items:this.itemsSelected}}).then(e=>{window.URL.createObjectURL(new Blob([e.data]));var i=window.URL.createObjectURL(new Blob([e.data])),o=document.createElement("a");o.href=i,o.setAttribute("download","buysell-report-list.xlsx"),document.body.appendChild(o),o.click()})},print(s=!0){s?r.post("/api/person/list/print").then(e=>{this.printID=e.data.id,window.open(this.$API_URL+"/front/print/"+this.printID,"_blank","noreferrer")}):this.itemsSelected.length===0?g.fire({text:"هیچ آیتمی انتخاب نشده است.",icon:"info",confirmButtonText:"قبول"}):r.post("/api/person/list/print",{items:this.itemsSelected}).then(e=>{this.printID=e.data.id,window.open(this.$API_URL+"/front/print/"+this.printID,"_blank","noreferrer")})}},beforeMount(){this.loadData()},watch:{dateStart:{handler:function(s,e){this.filter()},deep:!1},dateEnd:{handler:function(s,e){this.filter()},deep:!1},selectedCommodity:{handler:function(s,e){this.filter()},deep:!0},selectedType:{handler:function(s,e){this.filter()},deep:!0},itemsSelected:{handler:function(s,e){this.sumSelected=0,this.itemsSelected.forEach(i=>{this.sumSelected+=parseInt(i.priceAll.replaceAll(",",""))})},deep:!0}}},U={class:"block block-content-full"},j={id:"fixed-header",class:"block-header block-header-default bg-gray-light pt-2 pb-1"},A={class:"block-title text-primary-dark"},L={class:"block-options"},Y={hidden:"",class:"dropdown"},R={class:"dropdown-menu"},E={hidden:"",class:"dropdown"},I={class:"dropdown-menu"},B={class:"block-content pt-1 pb-3"},$={class:"row"},N={class:"col-sm-12 col-md-12 m-0 p-0"},O={class:"block-content pt-1 pb-3"},P={class:"row"},z={class:"col-sm-12 col-md-6"},q={class:"mb-2"},F={class:"row mb-1"},G={class:"col-12"},H={class:"col-12"},J={key:0},K={style:{direction:"ltr"}},Q={class:"col-sm-12 col-md-6"},W={class:"mb-2"},X={class:"row"},Z={class:"col-sm-12 col-md-6 mb-2"},ee={class:""},te={class:"col-sm-12 col-md-6 mb-2"},se={class:""},le={class:"row"},oe={class:"col-sm-12 col-md-12 m-0 p-0"},ae={class:"mb-1"},ie={class:"input-group input-group-sm"},de={class:"container-fluid p-0 mx-0 my-3"},ne={class:"block block-rounded block-link-shadow border-start border-success border-3",href:"javascript:void(0)"},re={class:"block-content block-content-full block-content-sm bg-body-light"},me={class:"row"},ce={class:"col-sm-6 com-md-6"},pe={class:"text-primary"},ue={class:"col-sm-6 com-md-6"},fe={class:"text-primary"};function be(s,e,i,o,he,f){const v=b("v-cob"),w=b("date-picker"),p=b("RouterLink"),V=b("EasyDataTable");return u(),x("div",U,[t("div",j,[t("h3",A,[t("button",{onClick:e[0]||(e[0]=l=>s.$router.back()),type:"button",class:"float-start d-none d-sm-none d-md-block btn btn-sm btn-link text-warning"},e[11]||(e[11]=[t("i",{class:"fa fw-bold fa-arrow-right"},null,-1)])),e[12]||(e[12]=t("i",{class:"fa-solid fa-chart-simple px-2"},null,-1)),e[13]||(e[13]=a(" گزارش خرید و فروش های به تفکیک کالا "))]),t("div",L,[t("div",Y,[e[14]||(e[14]=t("a",{class:"btn btn-sm btn-danger ms-2 dropdown-toggle text-end",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa fa-file-pdf"})],-1)),t("ul",R,[t("li",null,[t("a",{onClick:e[1]||(e[1]=h(l=>f.print(!1),["prevent"])),class:"dropdown-item",href:"#"},"انتخاب شده‌ها")]),t("li",null,[t("a",{onClick:e[2]||(e[2]=h(l=>f.print(!0),["prevent"])),class:"dropdown-item",href:"#"},"همه موارد")])])]),t("div",E,[e[15]||(e[15]=t("a",{class:"btn btn-sm btn-success ms-2 dropdown-toggle text-end",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa fa-file-excel"})],-1)),t("ul",I,[t("li",null,[t("a",{onClick:e[3]||(e[3]=h(l=>f.excellOutput(!1),["prevent"])),class:"dropdown-item",href:"#"},"انتخاب شده‌ها")]),t("li",null,[t("a",{onClick:e[4]||(e[4]=h(l=>f.excellOutput(!0),["prevent"])),class:"dropdown-item",href:"#"},"همه موارد")])])])])]),t("div",B,[t("div",$,[t("div",N,[t("div",O,[t("div",P,[t("div",z,[t("div",q,[e[20]||(e[20]=t("label",{class:"form-label"},"کالا و خدمات",-1)),c(v,{dir:"rtl",onSearch:f.searchCommodity,options:s.commoditys,label:"name",modelValue:s.selectedCommodity,"onUpdate:modelValue":e[5]||(e[5]=l=>s.selectedCommodity=l)},{"no-options":d(({search:l,searching:m,loading:M})=>e[16]||(e[16]=[a(" نتیجه‌ای یافت نشد! ")])),option:d(l=>[t("div",F,[t("div",G,[e[17]||(e[17]=t("i",{class:"fa fa-box me-1"},null,-1)),a(" "+n(l.name),1)]),t("div",H,[l.khadamat==!1?(u(),x("small",J,[e[18]||(e[18]=t("i",{class:"fa fa-store me-1"},null,-1)),e[19]||(e[19]=t("small",{class:"text-danger"}," موجودی: ",-1)),t("label",K,n(l.count),1),a(" "+n(l.unit),1)])):S("",!0)])])]),_:1},8,["onSearch","options","modelValue"])])]),t("div",Q,[t("div",W,[e[22]||(e[22]=t("label",{class:"form-label"},"نوع",-1)),c(v,{dir:"rtl",options:s.types,label:"label",modelValue:s.selectedType,"onUpdate:modelValue":e[6]||(e[6]=l=>s.selectedType=l)},{"no-options":d(({search:l,searching:m,loading:M})=>e[21]||(e[21]=[a(" نتیجه‌ای یافت نشد! ")])),_:1},8,["options","modelValue"])])])]),t("div",X,[t("div",Z,[t("div",ee,[e[23]||(e[23]=t("label",{class:"form-label"},"تاریخ شروع:",-1)),c(w,{class:"",modelValue:s.dateStart,"onUpdate:modelValue":e[7]||(e[7]=l=>s.dateStart=l),format:"jYYYY/jMM/jDD","display-format":"jYYYY/jMM/jDD",min:s.year.start,max:s.year.end},null,8,["modelValue","min","max"])])]),t("div",te,[t("div",se,[e[24]||(e[24]=t("label",{class:"form-label"},"تاریخ پایان:",-1)),c(w,{class:"",modelValue:s.dateEnd,"onUpdate:modelValue":e[8]||(e[8]=l=>s.dateEnd=l),format:"jYYYY/jMM/jDD","display-format":"jYYYY/jMM/jDD",min:s.dateStart,max:s.year.end},null,8,["modelValue","min","max"])])])]),t("div",le,[t("div",oe,[t("div",ae,[t("div",ie,[e[25]||(e[25]=t("span",{class:"input-group-text"},[t("i",{class:"fa fa-search"})],-1)),_(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>s.searchValue=l),class:"form-control",type:"text",placeholder:"جست و جو ..."},null,512),[[C,s.searchValue]])])]),c(V,{"table-class-name":"customize-table","items-selected":s.itemsSelected,"onUpdate:itemsSelected":e[10]||(e[10]=l=>s.itemsSelected=l),"multi-sort":"","show-index":"",alternating:"","search-value":s.searchValue,headers:s.headers,items:s.items,"theme-color":"#1d90ff","header-text-direction":"center","body-text-direction":"center",rowsPerPageMessage:"تعداد سطر",emptyMessage:"اطلاعاتی برای نمایش وجود ندارد",rowsOfPageSeparatorMessage:"از",loading:s.loading},{"item-docCode":d(({docCode:l})=>[c(p,{to:"/acc/accounting/view/"+l},{default:d(()=>[a(n(l),1)]),_:2},1032,["to"])]),"item-type":d(({docCode:l,type:m})=>[m=="buy"?(u(),y(p,{key:0,class:"text-success",to:"/acc/buy/view/"+l},{default:d(()=>e[26]||(e[26]=[a("خرید ")])),_:2},1032,["to"])):m=="sell"?(u(),y(p,{key:1,class:"text-danger",to:"/acc/sell/view/"+l},{default:d(()=>e[27]||(e[27]=[a("فروش ")])),_:2},1032,["to"])):m=="rfbuy"?(u(),y(p,{key:2,class:"text-info",to:"/acc/rfbuy/view/"+l},{default:d(()=>e[28]||(e[28]=[a("برگشت از خرید")])),_:2},1032,["to"])):m=="rfsell"?(u(),y(p,{key:3,class:"text-warning",to:"/acc/rfsell/view/"+l},{default:d(()=>e[29]||(e[29]=[a(" برگشت از فروش")])),_:2},1032,["to"])):S("",!0)]),"item-person":d(({person:l,type:m})=>[c(p,{to:"/acc/persons/card/view/"+l.code},{default:d(()=>[a(n(l.nikename),1)]),_:2},1032,["to"])]),_:1},8,["items-selected","search-value","headers","items","loading"]),t("div",de,[t("a",ne,[t("div",re,[t("div",me,[t("div",ce,[e[30]||(e[30]=t("span",{class:"text-dark"},[t("i",{class:"fa fa-list-dots"}),a(" مبلغ کل: ")],-1)),t("span",pe,n(s.$filters.formatNumber(this.sumMoneyTotal))+" "+n(s.$filters.getActiveMoney().shortName),1)]),t("div",ue,[e[31]||(e[31]=t("span",{class:"text-dark"},[t("i",{class:"fa fa-list-check"}),a(" جمع مبلغ موارد انتخابی: ")],-1)),t("span",fe,n(s.$filters.formatNumber(this.sumSelected))+" "+n(s.$filters.getActiveMoney().shortName),1)])])])])])])])])])])])])}const we=T(D,[["render",be]]);export{we as default};
