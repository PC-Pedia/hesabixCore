import{_ as D,a as d,S as x}from"./main-9b36f05f.js";import{r as S,a as h,o as r,s as b,e as t,d as a,aa as v,b as m,w as i,u as T,ab as U,t as c,A as w,c as y}from"./vendor-adef9cb4.js";const j={name:"buysellByPerson",data:()=>({loading:S(!0),sumSelected:0,sumTotal:0,year:{},persons:[],types:[{id:"buy",label:"خرید"},{id:"sell",label:"فروش"},{id:"rfbuy",label:"برگشت از خرید"},{id:"rfsell",label:"برگشت از فروش"},{id:"all",label:"همه موارد"}],dateStart:"",dateEnd:"",selectedType:{},selectedPerson:{},searchValue:"",loading:S(!0),items:[],itemsSelected:[],headers:[{text:"کد",value:"code"},{text:"سند حسابداری",value:"docCode"},{text:"نوع",value:"type"},{text:"تاریخ",value:"date"},{text:"کالا / خدمات",value:"khadamat",sortable:!0},{text:"نام کالا و خدمات",value:"name",sortable:!0},{text:"واحد شمارش",value:"unit",sortable:!0},{text:"تعداد",value:"count",sortable:!0},{text:"مبلغ فی",value:"priceOne",sortable:!0},{text:"مبلغ کل",value:"priceAll",sortable:!0},{text:"تجمعی",value:"amountInc",sortable:!0}]}),methods:{searchPerson(s,e){e(!0),d.post("/api/person/list/search",{search:s}).then(o=>{this.persons=o.data,e(!1)})},loadData(){d.post("/api/person/list/search").then(s=>{this.persons=s.data,this.persons.length!=0&&(this.selectedPerson=this.persons[0]),this.selectedType=this.types[0],this.loading=!1}),d.post("/api/year/get").then(s=>{this.year=s.data,this.loading=!1})},filter(){this.loading=!0,this.itemsSelected=[],d.post("/api/report/person/buysell",{type:this.selectedType.id,person:this.selectedPerson.code,dateStart:this.dateStart,dateEnd:this.dateEnd}).then(s=>{this.items=s.data;let e=0;this.sumTotal=0,this.items.forEach(o=>{e+=parseInt(o.priceAll.replaceAll(",","")),o.amountInc=this.$filters.formatNumber(e)}),this.sumTotal=e,this.loading=!1})},excellOutput(s=!0){s?d({method:"post",url:"/api/report/person/buysell/export/excel",responseType:"arraybuffer",data:{items:this.items}}).then(e=>{window.URL.createObjectURL(new Blob([e.data]));var o=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=o,n.setAttribute("download","buysell-report-list.xlsx"),document.body.appendChild(n),n.click()}):this.itemsSelected.length===0?x.fire({text:"هیچ آیتمی انتخاب نشده است.",icon:"info",confirmButtonText:"قبول"}):d({method:"post",url:"/api/report/person/buysell/export/excel",responseType:"arraybuffer",data:{items:this.itemsSelected}}).then(e=>{window.URL.createObjectURL(new Blob([e.data]));var o=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=o,n.setAttribute("download","buysell-report-list.xlsx"),document.body.appendChild(n),n.click()})},print(s=!0){s?d.post("/api/person/list/print").then(e=>{this.printID=e.data.id,window.open(this.$API_URL+"/front/print/"+this.printID,"_blank","noreferrer")}):this.itemsSelected.length===0?x.fire({text:"هیچ آیتمی انتخاب نشده است.",icon:"info",confirmButtonText:"قبول"}):d.post("/api/person/list/print",{items:this.itemsSelected}).then(e=>{this.printID=e.data.id,window.open(this.$API_URL+"/front/print/"+this.printID,"_blank","noreferrer")})}},beforeMount(){this.loadData()},watch:{dateStart:{handler:function(s,e){this.filter()},deep:!1},dateEnd:{handler:function(s,e){this.filter()},deep:!1},selectedPerson:{handler:function(s,e){this.filter()},deep:!0},selectedType:{handler:function(s,e){this.filter()},deep:!0},itemsSelected:{handler:function(s,e){this.sumSelected=0,this.itemsSelected.forEach(o=>{this.sumSelected+=parseInt(o.priceAll.replaceAll(",",""))})},deep:!0}}},M={class:"block block-content-full"},I={id:"fixed-header",class:"block-header block-header-default bg-gray-light pt-2 pb-1"},L={class:"block-title text-primary-dark"},Y={class:"block-options"},P={hidden:"",class:"dropdown"},R={class:"dropdown-menu"},E={class:"dropdown"},$={class:"dropdown-menu"},A={class:"block-content pt-1 pb-3"},B={class:"row"},N={class:"col-sm-12 col-md-12 m-0 p-0"},O={class:"block-content pt-1 pb-3"},C={class:"row"},z={class:"col-sm-12 col-md-6"},q={class:"mb-2"},F={class:"row mb-1"},G={class:"col-12"},H={class:"col-12"},J={class:"row"},K={class:"col-6"},Q={class:"col-6"},W={key:0,class:"text-danger"},X={key:1,class:"text-success"},Z={class:"col-sm-12 col-md-6"},ee={class:"mb-2"},te={class:"row"},se={class:"col-sm-12 col-md-6 mb-2"},le={class:""},ae={class:"col-sm-12 col-md-6 mb-2"},oe={class:""},ie={class:"row"},ne={class:"col-sm-12 col-md-12 m-0 p-0"},re={class:"mb-1"},de={class:"input-group input-group-sm"},ce={key:0},pe={key:1},me={class:"container-fluid p-0 mx-0 my-3"},ue={class:"block block-rounded block-link-shadow border-start border-success border-3",href:"javascript:void(0)"},fe={class:"block-content block-content-full block-content-sm bg-body-light"},be={class:"row"},he={class:"col-sm-6 com-md-6"},ve={class:"text-primary"},ye={class:"col-sm-6 com-md-6"},we={class:"text-primary"};function ke(s,e,o,n,ge,u){const k=h("v-cob"),g=h("date-picker"),f=h("RouterLink"),_=h("EasyDataTable");return r(),b("div",M,[t("div",I,[t("h3",L,[t("button",{onClick:e[0]||(e[0]=l=>s.$router.back()),type:"button",class:"float-start d-none d-sm-none d-md-block btn btn-sm btn-link text-warning"},e[11]||(e[11]=[t("i",{class:"fa fw-bold fa-arrow-right"},null,-1)])),e[12]||(e[12]=t("i",{class:"fa-solid fa-chart-simple px-2"},null,-1)),e[13]||(e[13]=a(" گزارش خرید و فروش های اشخاص "))]),t("div",Y,[t("div",P,[e[14]||(e[14]=t("a",{class:"btn btn-sm btn-danger ms-2 dropdown-toggle text-end",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa fa-file-pdf"})],-1)),t("ul",R,[t("li",null,[t("a",{onClick:e[1]||(e[1]=v(l=>u.print(!1),["prevent"])),class:"dropdown-item",href:"#"},"انتخاب شده‌ها")]),t("li",null,[t("a",{onClick:e[2]||(e[2]=v(l=>u.print(!0),["prevent"])),class:"dropdown-item",href:"#"},"همه موارد")])])]),t("div",E,[e[15]||(e[15]=t("a",{class:"btn btn-sm btn-success ms-2 dropdown-toggle text-end",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa fa-file-excel"})],-1)),t("ul",$,[t("li",null,[t("a",{onClick:e[3]||(e[3]=v(l=>u.excellOutput(!1),["prevent"])),class:"dropdown-item",href:"#"},"انتخاب شده‌ها")]),t("li",null,[t("a",{onClick:e[4]||(e[4]=v(l=>u.excellOutput(!0),["prevent"])),class:"dropdown-item",href:"#"},"همه موارد")])])])])]),t("div",A,[t("div",B,[t("div",N,[t("div",O,[t("div",C,[t("div",z,[t("div",q,[e[20]||(e[20]=t("label",{class:"form-label"},"شخص",-1)),m(k,{filterable:!1,dir:"rtl",onSearch:u.searchPerson,options:s.persons,label:"nikename",modelValue:s.selectedPerson,"onUpdate:modelValue":e[5]||(e[5]=l=>s.selectedPerson=l)},{"no-options":i(({search:l,searching:p,loading:V})=>e[16]||(e[16]=[a(" نتیجه‌ای یافت نشد! ")])),option:i(l=>[t("div",F,[t("div",G,[e[17]||(e[17]=t("i",{class:"fa fa-user me-2"},null,-1)),a(" "+c(l.nikename),1)]),t("div",H,[t("div",J,[t("div",K,[e[18]||(e[18]=t("i",{class:"fa fa-phone me-2"},null,-1)),a(" "+c(l.mobile),1)]),t("div",Q,[e[19]||(e[19]=t("i",{class:"fa fa-bars"},null,-1)),a(" تراز: "+c(s.$filters.formatNumber(Math.abs(parseInt(l.bs)-parseInt(l.bd))))+" ",1),parseInt(l.bs)-parseInt(l.bd)<0?(r(),b("span",W," بدهکار ")):w("",!0),parseInt(l.bs)-parseInt(l.bd)>0?(r(),b("span",X," بستانکار ")):w("",!0)])])])])]),_:1},8,["onSearch","options","modelValue"])])]),t("div",Z,[t("div",ee,[e[22]||(e[22]=t("label",{class:"form-label"},"نوع",-1)),m(k,{dir:"rtl",options:s.types,label:"label",modelValue:s.selectedType,"onUpdate:modelValue":e[6]||(e[6]=l=>s.selectedType=l)},{"no-options":i(({search:l,searching:p,loading:V})=>e[21]||(e[21]=[a(" نتیجه‌ای یافت نشد! ")])),_:1},8,["options","modelValue"])])])]),t("div",te,[t("div",se,[t("div",le,[e[23]||(e[23]=t("label",{class:"form-label"},"تاریخ شروع:",-1)),m(g,{class:"",modelValue:s.dateStart,"onUpdate:modelValue":e[7]||(e[7]=l=>s.dateStart=l),format:"jYYYY/jMM/jDD","display-format":"jYYYY/jMM/jDD",min:s.year.start,max:s.year.end},null,8,["modelValue","min","max"])])]),t("div",ae,[t("div",oe,[e[24]||(e[24]=t("label",{class:"form-label"},"تاریخ پایان:",-1)),m(g,{class:"",modelValue:s.dateEnd,"onUpdate:modelValue":e[8]||(e[8]=l=>s.dateEnd=l),format:"jYYYY/jMM/jDD","display-format":"jYYYY/jMM/jDD",min:s.dateStart,max:s.year.end},null,8,["modelValue","min","max"])])])]),t("div",ie,[t("div",ne,[t("div",re,[t("div",de,[e[25]||(e[25]=t("span",{class:"input-group-text"},[t("i",{class:"fa fa-search"})],-1)),T(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>s.searchValue=l),class:"form-control",type:"text",placeholder:"جست و جو ..."},null,512),[[U,s.searchValue]])])]),m(_,{"table-class-name":"customize-table","items-selected":s.itemsSelected,"onUpdate:itemsSelected":e[10]||(e[10]=l=>s.itemsSelected=l),"multi-sort":"","show-index":"",alternating:"","search-value":s.searchValue,headers:s.headers,items:s.items,"theme-color":"#1d90ff","header-text-direction":"center","body-text-direction":"center",rowsPerPageMessage:"تعداد سطر",emptyMessage:"اطلاعاتی برای نمایش وجود ندارد",rowsOfPageSeparatorMessage:"از",loading:s.loading},{"item-khadamat":i(({khadamat:l})=>[l==!1?(r(),b("label",ce,"کالا")):(r(),b("label",pe,"خدمات"))]),"item-docCode":i(({docCode:l})=>[m(f,{to:"/acc/accounting/view/"+l},{default:i(()=>[a(c(l),1)]),_:2},1032,["to"])]),"item-type":i(({docCode:l,type:p})=>[p=="buy"?(r(),y(f,{key:0,class:"text-success",to:"/acc/buy/view/"+l},{default:i(()=>e[26]||(e[26]=[a("خرید ")])),_:2},1032,["to"])):p=="sell"?(r(),y(f,{key:1,class:"text-danger",to:"/acc/sell/view/"+l},{default:i(()=>e[27]||(e[27]=[a("فروش ")])),_:2},1032,["to"])):p=="rfbuy"?(r(),y(f,{key:2,class:"text-info",to:"/acc/rfbuy/view/"+l},{default:i(()=>e[28]||(e[28]=[a("برگشت از خرید")])),_:2},1032,["to"])):p=="rfsell"?(r(),y(f,{key:3,class:"text-warning",to:"/acc/rfsell/view/"+l},{default:i(()=>e[29]||(e[29]=[a(" برگشت از فروش")])),_:2},1032,["to"])):w("",!0)]),_:1},8,["items-selected","search-value","headers","items","loading"]),t("div",me,[t("a",ue,[t("div",fe,[t("div",be,[t("div",he,[e[30]||(e[30]=t("span",{class:"text-dark"},[t("i",{class:"fa fa-list-dots"}),a(" مبلغ کل: ")],-1)),t("span",ve,c(s.$filters.formatNumber(this.sumTotal))+" "+c(s.$filters.getActiveMoney().shortName),1)]),t("div",ye,[e[31]||(e[31]=t("span",{class:"text-dark"},[t("i",{class:"fa fa-list-check"}),a(" جمع مبلغ موارد انتخابی: ")],-1)),t("span",we,c(s.$filters.formatNumber(this.sumSelected))+" "+c(s.$filters.getActiveMoney().shortName),1)])])])])])])])])])])])])}const _e=D(j,[["render",ke]]);export{_e as default};
