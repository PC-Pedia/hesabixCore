import{_ as F,a as v,S as u}from"./main-9b36f05f.js";import{r as I,a as r,o as U,s as B,b as e,w as o,F as $,_ as L,d as p,t as c,C as P,c as R}from"./vendor-adef9cb4.js";const G={name:"insert",data(){return{tabs:"0",prelabels:[],loading:!1,selectedTypes:[],person:{nikename:"",name:"",des:"",tel:"",mobile:"",mobile2:"",address:"",company:"",shenasemeli:"",codeeghtesadi:"",sabt:"",keshvar:"",ostan:"",shahr:"",postalcode:"",email:"",website:"",fax:"",code:0,types:[],accounts:[],prelabel:I(null),speedAccess:!1}}},mounted(){this.loadData(this.$route.params.id)},beforeRouteUpdate(s){this.loadData(s.params.id)},watch:{selectedTypes(s){this.person.types.forEach(l=>{l.checked=s.includes(l.label)})},"person.types":{handler(s){this.selectedTypes=s.filter(l=>l.checked).map(l=>l.label)},deep:!0,immediate:!0}},methods:{addNewCard(){this.person.accounts.push({bank:"",accountNum:"",cardNum:"",shabaNum:""})},removeCard(s){this.person.accounts.splice(s,1)},loadData(s=""){this.loading=!0,v.post("/api/person/prelabels/list").then(l=>{this.prelabels=l.data}).catch(l=>{u.fire({text:this.$t("pages.person.load_error")+l.message,icon:"error",confirmButtonText:this.$t("dialog.confirm")})}),s?v.post("/api/person/info/"+s).then(l=>{this.person=l.data,this.loading=!1}).catch(l=>{this.loading=!1,u.fire({text:this.$t("pages.person.load_error")+l.message,icon:"error",confirmButtonText:this.$t("dialog.confirm")})}):(v.post("/api/person/types/get").then(l=>{this.person.types=l.data,this.loading=!1}).catch(l=>{this.loading=!1,u.fire({text:this.$t("pages.person.load_error")+l.message,icon:"error",confirmButtonText:this.$t("dialog.confirm")})}),this.person.code=0)},async save(){let s=!0;if(this.person.mobile&&!/^(\+98|0)?9\d{9}$/.test(this.person.mobile)&&(s=!1,u.fire({text:this.$t("pages.person.invalid_mobile"),icon:"error",confirmButtonText:this.$t("dialog.confirm")})),this.person.nikename||(s=!1,u.fire({text:this.$t("pages.person.nickname_required"),icon:"error",confirmButtonText:this.$t("dialog.confirm")})),this.person.accounts.some(l=>!l.bank)&&(s=!1,u.fire({text:this.$t("pages.person.bank_required"),icon:"error",confirmButtonText:this.$t("dialog.confirm")})),s){this.loading=!0;try{const l=await v.post("/api/person/mod/"+this.person.code,this.person);this.loading=!1,l.data.result===2?u.fire({text:this.$t("pages.person.already_exists"),icon:"error",confirmButtonText:this.$t("dialog.confirm")}):u.fire({text:this.$t("pages.person.saved"),icon:"success",confirmButtonText:this.$t("dialog.confirm")}).then(()=>{this.$router.push("/acc/persons/list")})}catch(l){this.loading=!1,u.fire({text:this.$t("pages.person.save_error")+l.message,icon:"error",confirmButtonText:this.$t("dialog.confirm")})}}}}};function H(s,l,J,K,a,h){const V=r("v-btn"),w=r("v-tooltip"),T=r("v-spacer"),k=r("v-icon"),_=r("v-tab"),x=r("v-tabs"),C=r("v-toolbar"),q=r("v-switch"),t=r("v-col"),N=r("v-select"),d=r("v-text-field"),m=r("v-row"),f=r("v-card-text"),b=r("v-card"),g=r("v-tabs-window-item"),D=r("v-textarea"),S=r("v-toolbar-title"),A=r("v-tabs-window"),j=r("v-container"),z=r("v-progress-circular"),E=r("v-overlay");return U(),B($,null,[e(C,{color:"toolbar",title:s.$t("drawer.person_info")},{prepend:o(()=>[e(w,{text:s.$t("dialog.back"),location:"bottom"},{activator:o(({props:n})=>[e(V,L(n,{onClick:l[0]||(l[0]=y=>s.$router.back()),class:"d-none d-sm-flex",variant:"text",icon:"mdi-arrow-right"}),null,16)]),_:1},8,["text"])]),extension:o(()=>[e(x,{modelValue:a.tabs,"onUpdate:modelValue":l[1]||(l[1]=n=>a.tabs=n),color:"primary",grow:"",class:"bg-light"},{default:o(()=>[e(_,{value:"0"},{default:o(()=>[p(c(s.$t("pages.person.basic_info")),1)]),_:1}),e(_,{value:"1"},{default:o(()=>[p(c(s.$t("pages.person.eco_info")),1)]),_:1}),e(_,{value:"2"},{default:o(()=>[p(c(s.$t("pages.person.contact_info")),1)]),_:1}),e(_,{value:"3"},{default:o(()=>[p(c(s.$t("pages.person.address")),1)]),_:1}),e(_,{value:"4"},{default:o(()=>[p(c(s.$t("pages.person.banks_accounts")),1)]),_:1})]),_:1},8,["modelValue"])]),default:o(()=>[e(T),e(V,{loading:a.loading,onClick:h.save,icon:"",color:"green"},{default:o(()=>[e(k,null,{default:o(()=>l[24]||(l[24]=[p("mdi-content-save")])),_:1}),e(w,{activator:"parent",text:s.$t("dialog.save"),location:"bottom"},null,8,["text"])]),_:1},8,["loading","onClick"])]),_:1},8,["title"]),e(j,{fluid:"",class:"pa-2"},{default:o(()=>[e(m,null,{default:o(()=>[e(t,{cols:"12"},{default:o(()=>[e(A,{modelValue:a.tabs,"onUpdate:modelValue":l[23]||(l[23]=n=>a.tabs=n)},{default:o(()=>[e(g,{value:"0"},{default:o(()=>[e(b,{flat:""},{default:o(()=>[e(f,{class:"pa-2"},{default:o(()=>[e(m,{dense:""},{default:o(()=>[e(t,{cols:"12"},{default:o(()=>[e(q,{modelValue:a.person.speedAccess,"onUpdate:modelValue":l[2]||(l[2]=n=>a.person.speedAccess=n),label:s.$t("pages.person.speed_access"),color:"primary",inset:"","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12"},{default:o(()=>[e(N,{modelValue:a.selectedTypes,"onUpdate:modelValue":l[3]||(l[3]=n=>a.selectedTypes=n),items:a.person.types,"item-title":"label","item-value":"label",label:s.$t("pages.person.customer_type"),multiple:"",dense:"","hide-details":"",chips:"","deletable-chips":"","prepend-inner-icon":"mdi-account-group"},null,8,["modelValue","items","label"])]),_:1}),e(t,{cols:"12",md:"4"},{default:o(()=>[e(N,{modelValue:a.person.prelabel,"onUpdate:modelValue":l[4]||(l[4]=n=>a.person.prelabel=n),items:a.prelabels,"item-title":"label","item-value":"label",label:s.$t("dialog.prelabel"),clearable:"",dense:"","hide-details":""},null,8,["modelValue","items","label"])]),_:1}),e(t,{cols:"12",md:"4"},{default:o(()=>[e(d,{modelValue:a.person.nikename,"onUpdate:modelValue":l[5]||(l[5]=n=>a.person.nikename=n),label:s.$t("pages.person.nickname"),required:"",dense:"","prepend-inner-icon":"mdi-account",rules:[n=>!!n||s.$t("validator.required")],"hide-details":""},null,8,["modelValue","label","rules"])]),_:1}),e(t,{cols:"12",md:"4"},{default:o(()=>[e(d,{modelValue:a.person.company,"onUpdate:modelValue":l[6]||(l[6]=n=>a.person.company=n),label:s.$t("pages.person.company"),dense:"","prepend-inner-icon":"mdi-domain","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.name,"onUpdate:modelValue":l[7]||(l[7]=n=>a.person.name=n),label:s.$t("pages.person.name"),dense:"","prepend-inner-icon":"mdi-account-outline","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.des,"onUpdate:modelValue":l[8]||(l[8]=n=>a.person.des=n),label:s.$t("pages.person.description"),dense:"","prepend-inner-icon":"mdi-text","hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{value:"1"},{default:o(()=>[e(b,{flat:""},{default:o(()=>[e(f,{class:"pa-2"},{default:o(()=>[e(m,{dense:""},{default:o(()=>[e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.shenasemeli,"onUpdate:modelValue":l[9]||(l[9]=n=>a.person.shenasemeli=n),label:s.$t("pages.person.national_id"),dense:"","prepend-inner-icon":"mdi-card-account-details","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.sabt,"onUpdate:modelValue":l[10]||(l[10]=n=>a.person.sabt=n),label:s.$t("pages.person.registration_number"),dense:"","prepend-inner-icon":"mdi-numeric","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.codeeghtesadi,"onUpdate:modelValue":l[11]||(l[11]=n=>a.person.codeeghtesadi=n),label:s.$t("pages.person.economic_code"),dense:"","prepend-inner-icon":"mdi-barcode","hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{value:"2"},{default:o(()=>[e(b,{flat:""},{default:o(()=>[e(f,{class:"pa-2"},{default:o(()=>[e(m,{dense:""},{default:o(()=>[e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.mobile,"onUpdate:modelValue":l[12]||(l[12]=n=>a.person.mobile=n),label:s.$t("pages.person.mobile"),dense:"","prepend-inner-icon":"mdi-phone",dir:"ltr","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.mobile2,"onUpdate:modelValue":l[13]||(l[13]=n=>a.person.mobile2=n),label:s.$t("pages.person.mobile2"),dense:"","prepend-inner-icon":"mdi-phone-plus",dir:"ltr","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.tel,"onUpdate:modelValue":l[14]||(l[14]=n=>a.person.tel=n),label:s.$t("pages.person.phone"),dense:"","prepend-inner-icon":"mdi-phone-classic",dir:"ltr","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.fax,"onUpdate:modelValue":l[15]||(l[15]=n=>a.person.fax=n),label:s.$t("pages.person.fax"),dense:"","prepend-inner-icon":"mdi-fax",dir:"ltr","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.email,"onUpdate:modelValue":l[16]||(l[16]=n=>a.person.email=n),label:s.$t("pages.person.email"),dense:"","prepend-inner-icon":"mdi-email",dir:"ltr","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.website,"onUpdate:modelValue":l[17]||(l[17]=n=>a.person.website=n),label:s.$t("pages.person.website"),dense:"","prepend-inner-icon":"mdi-web",dir:"ltr","hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{value:"3"},{default:o(()=>[e(b,{flat:""},{default:o(()=>[e(f,{class:"pa-2"},{default:o(()=>[e(m,{dense:""},{default:o(()=>[e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.keshvar,"onUpdate:modelValue":l[18]||(l[18]=n=>a.person.keshvar=n),label:s.$t("pages.person.country"),dense:"","prepend-inner-icon":"mdi-earth","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.ostan,"onUpdate:modelValue":l[19]||(l[19]=n=>a.person.ostan=n),label:s.$t("pages.person.province"),dense:"","prepend-inner-icon":"mdi-map-marker","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.shahr,"onUpdate:modelValue":l[20]||(l[20]=n=>a.person.shahr=n),label:s.$t("pages.person.city"),dense:"","prepend-inner-icon":"mdi-city","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:a.person.postalcode,"onUpdate:modelValue":l[21]||(l[21]=n=>a.person.postalcode=n),label:s.$t("pages.person.postal_code"),dense:"","prepend-inner-icon":"mdi-mailbox","hide-details":""},null,8,["modelValue","label"])]),_:1}),e(t,{cols:"12"},{default:o(()=>[e(D,{modelValue:a.person.address,"onUpdate:modelValue":l[22]||(l[22]=n=>a.person.address=n),label:s.$t("pages.person.address"),dense:"","prepend-inner-icon":"mdi-home",rows:"2","hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(g,{value:"4"},{default:o(()=>[e(b,{flat:""},{default:o(()=>[e(f,{class:"pa-2"},{default:o(()=>[e(m,{justify:"end",class:"mb-2"},{default:o(()=>[e(t,{cols:"auto"},{default:o(()=>[e(V,{color:"primary",onClick:h.addNewCard,"prepend-icon":"mdi-plus",size:"small"},{default:o(()=>[p(c(s.$t("dialog.add")),1)]),_:1},8,["onClick"])]),_:1})]),_:1}),(U(!0),B($,null,P(a.person.accounts,(n,y)=>(U(),R(m,{key:y,dense:"",class:"mb-2"},{default:o(()=>[e(t,{cols:"12"},{default:o(()=>[e(b,{outlined:"",elevation:"2"},{default:o(()=>[e(C,{flat:"",color:"grey-lighten-4",dense:""},{default:o(()=>[e(k,{left:""},{default:o(()=>l[25]||(l[25]=[p("mdi-bank")])),_:1}),e(S,{class:"text-subtitle-2"},{default:o(()=>[p(c(s.$t("pages.person.bank_account")),1)]),_:1}),e(T),e(V,{icon:"",color:"red",onClick:i=>h.removeCard(y),small:""},{default:o(()=>[e(k,null,{default:o(()=>l[26]||(l[26]=[p("mdi-trash-can")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(f,{class:"pa-2"},{default:o(()=>[e(m,{dense:""},{default:o(()=>[e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:n.bank,"onUpdate:modelValue":i=>n.bank=i,label:s.$t("pages.person.bank_name"),dense:"","prepend-inner-icon":"mdi-bank",rules:[i=>!!i||s.$t("validator.required")],"hide-details":""},null,8,["modelValue","onUpdate:modelValue","label","rules"])]),_:2},1024),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:n.accountNum,"onUpdate:modelValue":i=>n.accountNum=i,label:s.$t("pages.person.account_number"),dense:"","prepend-inner-icon":"mdi-numeric","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:n.cardNum,"onUpdate:modelValue":i=>n.cardNum=i,label:s.$t("pages.person.card_number"),dense:"","prepend-inner-icon":"mdi-credit-card","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),e(t,{cols:"12",md:"6"},{default:o(()=>[e(d,{modelValue:n.shabaNum,"onUpdate:modelValue":i=>n.shabaNum=i,label:s.$t("pages.person.shaba_number"),dense:"","prepend-inner-icon":"mdi-barcode","hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(E,{"model-value":a.loading,contained:"",class:"align-center justify-center"},{default:o(()=>[e(z,{indeterminate:"",size:"64"})]),_:1},8,["model-value"])],64)}const Q=F(G,[["render",H],["__scopeId","data-v-64f355bc"]]);export{Q as default};
