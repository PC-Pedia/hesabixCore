import{_ as q,a as $,S as d}from"./main-9b36f05f.js";import{a as n,o as m,s as p,b as t,w as a,F as C,_ as c,e as w,t as y,aa as M}from"./vendor-adef9cb4.js";const O={name:"plugins",data:()=>({dialog:!1,loading:!0,selected:{id:null,name:"",price:0,time:0},rules:{required:[e=>!!e||"این فیلد الزامی است"]},items:[],headers:[{text:"نام افزونه",value:"name"},{text:"قیمت(تومان)",value:"price"},{text:"پیشفرض فعال",value:"defaultOn"},{text:"دوره اعتبار(ثانیه)",value:"time"},{text:"برچسب زمان",value:"timeLabel"},{text:"ویرایش",value:"operation"}]}),methods:{async loadData(){try{const e=await $.post("/api/admin/plugins/list");this.items=e.data.map(o=>({...o,price:Number(o.price),time:Number(o.time)})),this.loading=!1}catch{d.fire({text:"خطا در دریافت لیست افزونه‌ها!",icon:"error",confirmButtonText:"باشه"}),this.loading=!1}},async editPlugin(){var o,r;const{valid:e}=await this.$refs.form.validate();if(e){this.loading=!0;try{(await $.post("/api/admin/plugin/update/data",this.selected)).data.Success?(d.fire({text:this.$t("dialog.save_ok"),icon:"success",confirmButtonText:this.$t("dialog.ok")}),this.loadData()):d.fire({text:"خطا در به‌روزرسانی افزونه!",icon:"warning",confirmButtonText:"باشه"})}catch(i){d.fire({text:`خطا در ارتباط با سرور: ${((r=(o=i.response)==null?void 0:o.data)==null?void 0:r.message)||i.message}`,icon:"error",confirmButtonText:"باشه"})}this.loading=!1,this.dialog=!1}}},beforeMount(){this.loadData()}},L={key:0},E={key:1};function I(e,o,r,i,F,k){const B=n("v-spacer"),f=n("v-toolbar"),u=n("v-btn"),S=n("EasyDataTable"),s=n("v-col"),g=n("v-row"),v=n("v-card-text"),b=n("v-card"),D=n("v-container"),_=n("v-tooltip"),V=n("v-text-field"),h=n("v-number-input"),N=n("v-switch"),P=n("v-form"),T=n("v-dialog");return m(),p(C,null,[t(f,{color:"toolbar",title:e.$t("dialog.plugins")+" : ("+e.items.length+")"},{default:a(()=>[t(B)]),_:1},8,["title"]),t(D,{class:"pa-0 ma-0"},{default:a(()=>[t(b,{loading:e.loading?"red":null,disabled:e.loading},{default:a(()=>[t(v,{class:"pa-0"},{default:a(()=>[t(g,null,{default:a(()=>[t(s,null,{default:a(()=>[t(S,{"table-class-name":"customize-table","show-index":"",alternating:"",headers:e.headers,items:e.items,rowsPerPageMessage:"تعداد سطر",emptyMessage:"اطلاعاتی برای نمایش وجود ندارد",rowsOfPageSeparatorMessage:"از","theme-color":"#1d90ff","header-text-direction":"center","body-text-direction":"center",loading:e.loading},{"item-operation":a(l=>[t(u,c({variant:"text",onClick:U=>{e.selected=l,e.dialog=!0},color:"success",icon:"mdi-file-edit"},l),null,16,["onClick"])]),"item-defaultOn":a(({defaultOn:l})=>[l?(m(),p("span",L,"بله")):(m(),p("span",E,"‌خیر"))]),"item-time":a(({time:l})=>[w("span",null,y(e.$filters.formatNumber(l)),1)]),"item-price":a(({price:l})=>[w("span",null,y(e.$filters.formatNumber(l)),1)]),_:1},8,["headers","items","loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["loading","disabled"])]),_:1}),t(T,{fullscreen:"",modelValue:e.dialog,"onUpdate:modelValue":o[6]||(o[6]=l=>e.dialog=l),width:"auto"},{default:a(()=>[t(b,{loading:e.loading,"min-width":"400"},{default:a(()=>[t(P,{disabled:e.loading,ref:"form",onSubmit:M(k.editPlugin,["prevent"])},{default:a(()=>[t(f,{class:"fixed-top",color:"toolbar",title:e.$t("dialog.edit_plugin")},{append:a(()=>[t(_,{text:e.$t("dialog.save"),location:"bottom"},{activator:a(({props:l})=>[t(u,c({color:"success"},l,{type:"submit",class:"d-none d-sm-flex",variant:"text",icon:"mdi-content-save"}),null,16)]),_:1},8,["text"])]),prepend:a(()=>[t(_,{text:e.$t("dialog.close"),location:"bottom"},{activator:a(({props:l})=>[t(u,c(l,{onClick:o[0]||(o[0]=U=>e.dialog=!1),class:"d-none d-sm-flex",variant:"text",icon:"mdi-close"}),null,16)]),_:1},8,["text"])]),_:1},8,["title"]),t(v,{class:""},{default:a(()=>[t(g,null,{default:a(()=>[t(s,{cols:"12"},{default:a(()=>[t(V,{rules:e.rules.required,modelValue:e.selected.name,"onUpdate:modelValue":o[1]||(o[1]=l=>e.selected.name=l),label:e.$t("dialog.plugin_name")},null,8,["rules","modelValue","label"])]),_:1}),t(s,{cols:"12"},{default:a(()=>[t(h,{rules:e.rules.required,control:"",Variant:"stacked",modelValue:e.selected.price,"onUpdate:modelValue":o[2]||(o[2]=l=>e.selected.price=l),label:e.$t("dialog.price"),hideInput:!1,inset:""},null,8,["rules","modelValue","label"])]),_:1}),t(s,{cols:"12"},{default:a(()=>[t(h,{rules:e.rules.required,control:"",Variant:"stacked",modelValue:e.selected.time,"onUpdate:modelValue":o[3]||(o[3]=l=>e.selected.time=l),label:e.$t("dialog.time"),hideInput:!1,inset:""},null,8,["rules","modelValue","label"])]),_:1}),t(s,{cols:"12"},{default:a(()=>[t(V,{control:"",Variant:"stacked",modelValue:e.selected.timeLabel,"onUpdate:modelValue":o[4]||(o[4]=l=>e.selected.timeLabel=l),rules:e.rules.required,label:e.$t("dialog.timeLabel"),hideInput:!1,inset:""},null,8,["modelValue","rules","label"])]),_:1}),t(s,{cols:"12 mb-0"},{default:a(()=>[t(N,{color:"primary",modelValue:e.selected.defaultOn,"onUpdate:modelValue":o[5]||(o[5]=l=>e.selected.defaultOn=l),label:e.$t("dialog.default_on"),inset:""},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["loading"])]),_:1},8,["modelValue"])],64)}const A=q(O,[["render",I]]);export{A as default};
