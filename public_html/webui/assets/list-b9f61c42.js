import{_ as T,a as m,S}from"./main-9b36f05f.js";import{r as E,a as k,o as b,s as g,e,d as i,b as f,w as r,u as p,ao as _,ab as y,au as B,F as x,C,t as n}from"./vendor-adef9cb4.js";const U={name:"list",components:{history},watch:{"singleChangeStateSelected.code"(s,t){this.items.forEach(l=>{l.code==s&&(this.singleChangeStateSelected=l,this.singleChangeStateSelected.person.mobile==""&&(this.singleChangeStateSelected.sms=!1))})},searchValue(s,t){this.searchTable()}},data:()=>({orderStates:[],singleChangeStateSelected:{code:0,person:{nikename:""},commodity:{name:""}},searchValue:"",loading:E(!0),items:[],orgItems:[],headers:[{text:"عملیات",value:"operation"},{text:"کد",value:"code"},{text:"مشتری",value:"person",sortable:!0,width:150},{text:"کالا",value:"commodity",sortable:!0,width:150},{text:"تاریخ",value:"date",sortable:!0,width:100},{text:"وضعیت",value:"state",sortable:!0,width:150},{text:"تاریخ تحویل",value:"dateOut",sortable:!0,width:100}],logItems:[],logHeaders:[{text:"تاریخ",value:"date"},{text:"شرح",value:"des"},{text:"ثبت کننده",value:"user"}]}),methods:{changeItem(s){this.loading=!0,m.post("/api/plug/repservice/order/logs/"+s).then(t=>{this.loading=!1,this.logItems=t.data})},filterTable(){this.loading=!0;let s=[],t=!0,l=[];this.orderStates.forEach(o=>{o.checked==!0&&(t=!1,l.push(o))}),t?this.items=this.orgItems:(this.orgItems.forEach(o=>{l.forEach(u=>{if(u.code==o.state.code){let d=!1;s.forEach(h=>{o.state.code==h.code&&(d=!0)}),d==!1&&s.push(o)}})}),this.items=s),this.loading=!1},searchTable(){this.loading=!0;let s=[],t=!1;this.searchValue==""&&(t=!0),t?this.items=this.orgItems:(this.orgItems.forEach(l=>{let o=!1;(l.commodity.name.includes(this.searchValue)||l.person.nikename.includes(this.searchValue)||l.des.includes(this.searchValue)||l.state.label.includes(this.searchValue)||l.date.includes(this.searchValue))&&(o=!0),o&&s.push(l)}),this.items=s),this.loading=!1},loadData(){m.post("/api/plug/repservice/order/list").then(s=>{this.items=s.data,this.orgItems=s.data,this.loading=!1}),m.post("/api/plug/repservice/order/state/list").then(s=>{this.orderStates=s.data})},changeStateSingle(){this.loading=!0,m.post("/api/plug/repservice/order/state/change",this.singleChangeStateSelected).then(s=>{this.loading=!1,s.data.code=="0"&&S.fire({text:"وضعیت درخواست به روز شد.",icon:"success",confirmButtonText:"قبول"}),this.loadData()})},deleteItem(s){S.fire({text:"آیا برای حذف درخواست مطمئن هستید؟",showCancelButton:!0,confirmButtonText:"بله",cancelButtonText:"خیر"}).then(t=>{t.isConfirmed&&m.post("/api/repservice/order/remove/"+s).then(l=>{if(l.data.result==1){let o=0;for(let u=0;u<this.items.length;u++)o++,this.items[u].code==s&&this.items.splice(o-1,1);S.fire({text:"درخواست با موفقیت حذف شد.",icon:"success",confirmButtonText:"قبول"})}})})},printInvoice(s){this.loading=!0,m.post("/api/repservice/print/invoice",{code:s}).then(t=>{this.loading=!1,window.open(this.$API_URL+"/front/print/"+t.data.id,"_blank","noreferrer")})}},mounted(){this.loadData();const s=document.getElementById("changeSingleStateModal");s&&s.addEventListener("show.bs.modal",t=>{const l=t.relatedTarget;this.singleChangeStateSelected.code=l.getAttribute("data-bs-whatever");const o=s.querySelector(".modal-title");o.textContent=`تغییر وضعیت درخواست  ${this.singleChangeStateSelected.code}`})}},$={class:"block block-content-full"},D={id:"fixed-header",class:"block-header block-header-default bg-gray-light pt-2 pb-1"},L={class:"block-title text-primary-dark"},P={class:"block-options"},z={class:"dropdown-center"},A={"aria-labelledby":"dropdown-align-center-outline-primary",class:"dropdown-menu dropdown-menu-end",style:{}},N={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:"changeSingleStateModal",tabindex:"-1","aria-labelledby":"changeSingleStateModalLabel","aria-hidden":"true"},O={class:"modal-dialog"},F={class:"modal-content"},H={class:"modal-body"},q={class:"row"},R={class:"col-sm-12 col-md-12 mb-2"},j={class:"form-check form-switch form-check-inline"},G=["disabled"],J={class:"col-sm-12 col-md-6 mb-2"},K={class:"input-group input-group-sm"},Q={class:"col-sm-12 col-md-6 mb-2"},W={class:"input-group input-group-sm"},X={class:"col-sm-12 col-md-12 mb-2"},Y={class:"input-group input-group-sm"},Z=["value"],ee={class:"modal-footer"},te={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:"historyModal",tabindex:"-1","aria-labelledby":"historyModalModalLabel","aria-hidden":"true"},se={class:"modal-dialog modal-xl"},ae={class:"modal-content"},oe={class:"modal-body"},le={class:"block-content pt-1 pb-3"},ie={class:"row"},ne={class:"col-sm-12 col-md-12 m-0 p-0"},de={class:"mb-1"},re={class:"input-group input-group-sm"},ce={class:"col-sm-12 col-md-12 border rounded mb-2 px-2 py-1"},ue={class:"form-check form-check-inline"},me=["onUpdate:modelValue"],pe={class:"form-check-label"},he={class:"dropdown-center",style:{"z-index":"1000"}},be={"aria-labelledby":"dropdown-align-center-outline-primary",class:"dropdown-menu dropdown-menu-end",style:{}},ge=["data-bs-whatever"],fe=["onClick"],ve=["data-bs-whatever"],Se=["onClick","data-bs-whatever"],ye=["onClick"],we={class:"container text-start"},ke={class:"row my-1"},_e={class:"col"},xe={class:"row mb-1"},Ce={class:"col"},Ve={class:"row mb-1"},Me={class:"col"},Ie={class:"row mb-1"},Te={class:"col"},Ee={class:"row mb-1"},Be={class:"col"},Ue={class:"row mb-1"},$e={class:"col"};function De(s,t,l,o,u,d){const h=k("router-link"),w=k("EasyDataTable");return b(),g("div",$,[e("div",D,[e("h3",L,[e("button",{onClick:t[0]||(t[0]=a=>s.$router.back()),type:"button",class:"float-start d-none d-sm-none d-md-block btn btn-sm btn-link text-warning"},t[8]||(t[8]=[e("i",{class:"fa fw-bold fa-arrow-right"},null,-1)])),t[9]||(t[9]=i(" درخواست‌ها "))]),e("div",P,[e("div",z,[t[11]||(t[11]=e("button",{"aria-expanded":"false","aria-haspopup":"true",class:"btn btn-sm btn-link","data-bs-toggle":"dropdown",id:"dropdown-align-center-alt-primary",type:"button"},[e("i",{class:"fa-solid fa-ellipsis"})],-1)),e("div",A,[f(h,{class:"dropdown-item",to:"/acc/plugin/repservice/order/mod/"},{default:r(()=>t[10]||(t[10]=[e("i",{class:"fa fa-plus text-success pe-2"},null,-1),i(" درخواست جدید ")])),_:1})])])])]),e("div",N,[e("div",O,[e("div",F,[t[17]||(t[17]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"changeSingleStateModalLabel"},"تغییر وضعیت درخواست"),e("div",{class:"block-options"},[e("button",{type:"button",class:"btn-close btn-close-change-state","data-bs-dismiss":"modal","aria-label":"Close"})])],-1)),e("div",H,[e("div",q,[e("div",R,[e("span",j,[p(e("input",{disabled:this.singleChangeStateSelected.person.mobile=="","onUpdate:modelValue":t[1]||(t[1]=a=>s.singleChangeStateSelected.sms=a),class:"form-check-input",type:"checkbox"},null,8,G),[[_,s.singleChangeStateSelected.sms]]),t[12]||(t[12]=e("label",{class:"form-check-label"},"ارسال پیامک",-1))])]),e("div",J,[e("div",K,[t[13]||(t[13]=e("span",{class:"input-group-text"},"مشتری",-1)),p(e("input",{type:"text",readonly:"readonly",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=a=>s.singleChangeStateSelected.person.nikename=a)},null,512),[[y,s.singleChangeStateSelected.person.nikename]])])]),e("div",Q,[e("div",W,[t[14]||(t[14]=e("span",{class:"input-group-text"},"کالا",-1)),p(e("input",{type:"text",readonly:"readonly",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=a=>s.singleChangeStateSelected.commodity.name=a)},null,512),[[y,s.singleChangeStateSelected.commodity.name]])])]),e("div",X,[e("div",Y,[t[15]||(t[15]=e("label",{class:"input-group-text bg-success text-light"},"وضعیت",-1)),p(e("select",{"onUpdate:modelValue":t[4]||(t[4]=a=>s.singleChangeStateSelected.state=a),class:"form-select"},[(b(!0),g(x,null,C(s.orderStates,a=>(b(),g("option",{value:a},n(a.label),9,Z))),256))],512),[[B,s.singleChangeStateSelected.state]])])])])]),e("div",ee,[t[16]||(t[16]=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"بازگشت",-1)),e("button",{onClick:t[5]||(t[5]=a=>d.changeStateSingle()),type:"button","data-bs-dismiss":"modal",class:"btn btn-primary"},"ثبت")])])])]),e("div",te,[e("div",se,[e("div",ae,[t[18]||(t[18]=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"historyModalModalLabel"},"تاریخچه"),e("div",{class:"block-options"},[e("button",{type:"button",class:"btn-close btn-close-change-state","data-bs-dismiss":"modal","aria-label":"Close"})])],-1)),e("div",oe,[f(w,{"table-class-name":"customize-table","multi-sort":"","show-index":"",alternating:"",headers:s.logHeaders,items:s.logItems,"theme-color":"#1d90ff","header-text-direction":"center","body-text-direction":"center",rowsPerPageMessage:"تعداد سطر",emptyMessage:"اطلاعاتی برای نمایش وجود ندارد",rowsOfPageSeparatorMessage:"از",loading:s.loading},null,8,["headers","items","loading"])]),t[19]||(t[19]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"بازگشت")],-1))])])]),e("div",le,[e("div",ie,[e("div",ne,[e("div",de,[e("div",re,[t[20]||(t[20]=e("span",{class:"input-group-text"},[e("i",{class:"fa fa-search"})],-1)),p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>s.searchValue=a),class:"form-control",type:"text",placeholder:"جست و جو ..."},null,512),[[y,s.searchValue]])])]),e("div",ce,[(b(!0),g(x,null,C(s.orderStates,(a,c)=>(b(),g("div",ue,[p(e("input",{onChange:t[7]||(t[7]=v=>d.filterTable()),"onUpdate:modelValue":v=>s.orderStates[c].checked=v,checked:"",class:"form-check-input",type:"checkbox"},null,40,me),[[_,s.orderStates[c].checked]]),e("label",pe,n(a.label),1)]))),256))]),f(w,{"table-class-name":"customize-table","multi-sort":"","show-index":"",alternating:"",headers:s.headers,items:s.items,"theme-color":"#1d90ff","header-text-direction":"center","body-text-direction":"center",rowsPerPageMessage:"تعداد سطر",emptyMessage:"اطلاعاتی برای نمایش وجود ندارد",rowsOfPageSeparatorMessage:"از",loading:s.loading},{"item-operation":r(({code:a})=>[e("div",he,[t[27]||(t[27]=e("button",{"aria-expanded":"false","aria-haspopup":"true",class:"btn btn-sm btn-link","data-bs-toggle":"dropdown",id:"dropdown-align-center-alt-primary",type:"button"},[e("i",{class:"fa-solid fa-ellipsis"})],-1)),e("div",be,[f(h,{class:"dropdown-item",to:"/acc/plugin/repservice/order/mod/"+a},{default:r(()=>t[21]||(t[21]=[e("i",{class:"fa fa-edit pe-2"},null,-1),i(" ویرایش ")])),_:2},1032,["to"]),e("button",{type:"button",class:"dropdown-item","data-bs-toggle":"modal","data-bs-target":"#changeSingleStateModal","data-bs-whatever":a},t[22]||(t[22]=[e("i",{class:"fa-solid fa-bolt pe-2"},null,-1),i(" تغییر وضعیت ")]),8,ge),e("button",{type:"button",class:"dropdown-item","data-bs-toggle":"modal",onClick:c=>d.printInvoice(a)},t[23]||(t[23]=[e("i",{class:"fa-solid fa-print pe-2"},null,-1),i(" چاپ قبض رسید ")]),8,fe),e("button",{type:"button",class:"dropdown-item","data-bs-toggle":"modal","data-bs-target":"#changeSingleStateModal","data-bs-whatever":a},t[24]||(t[24]=[e("i",{class:"fa-solid fa-bolt pe-2"},null,-1),i(" تغییر وضعیت ")]),8,ve),e("button",{type:"button",class:"dropdown-item","data-bs-toggle":"modal","data-bs-target":"#historyModal",onClick:c=>d.changeItem(a),"data-bs-whatever":a},t[25]||(t[25]=[e("i",{class:"fa fa-list pe-2"},null,-1),i(" تاریخچه ")]),8,Se),e("button",{type:"button",class:"dropdown-item",onClick:c=>d.deleteItem(a)},t[26]||(t[26]=[e("i",{class:"fa fa-trash text-danger pe-2"},null,-1),i(" حذف ")]),8,ye)])])]),"item-person":r(({person:a})=>[f(h,{to:"/acc/persons/card/view/"+a.code},{default:r(()=>[i(n(a.nikename),1)]),_:2},1032,["to"])]),"item-commodity":r(({commodity:a})=>[i(n(a.name),1)]),"item-state":r(({state:a})=>[i(n(a.label),1)]),expand:r(({des:a,motaleghat:c,serial:v,pelak:V,model:M,color:I})=>[e("div",we,[e("div",ke,[e("div",_e,[t[28]||(t[28]=e("strong",null,"شرح: ",-1)),i(" "+n(a),1)])]),e("div",xe,[e("div",Ce,[t[29]||(t[29]=e("strong",null,"متعلقات: ",-1)),i(" "+n(c),1)])]),e("div",Ve,[e("div",Me,[t[30]||(t[30]=e("strong",null,"پلاک: ",-1)),i(" "+n(V),1)])]),e("div",Ie,[e("div",Te,[t[31]||(t[31]=e("strong",null,"سریال: ",-1)),i(" "+n(v),1)])]),e("div",Ee,[e("div",Be,[t[32]||(t[32]=e("strong",null,"مدل: ",-1)),i(" "+n(M),1)])]),e("div",Ue,[e("div",$e,[t[33]||(t[33]=e("strong",null,"رنگ: ",-1)),i(" "+n(I),1)])])])]),_:1},8,["headers","items","loading"])])])])])}const ze=T(U,[["render",De]]);export{ze as default};
