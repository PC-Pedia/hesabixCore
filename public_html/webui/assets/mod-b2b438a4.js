import{_ as Z,l as tt,L as et,a as c,S as m}from"./main-9b36f05f.js";import{a as r,o as u,s as h,b as a,w as i,F as B,_ as p,d,t as l,e as s,A as y,u as x,ab as U,ao as st,C as F,c as ot}from"./vendor-adef9cb4.js";import"./vue-persian-datetime-picker.common-0e5ba5b7.js";import{q as at,a as it}from"./quickAddCommodity-50dce749.js";import{q as lt}from"./quickAdd-3f821e67.js";import{m as dt}from"./mostdes-26bfade0.js";import"./vue3-treeselect.common-f8cf97d9.js";/* empty css                        */const nt={name:"mod",components:{Money3:tt,Loading:et,quickView:at,quickAdd:lt,quickAddCommodity:it,mostdes:dt},data:()=>({tabs:0,buyDocs:[],pair_docs:[],addsheet:!1,editsheet:!1,priceList:[],selectedPriceList:{id:0,label:"پیشفرض"},plugins:{},maliyatCheck:!0,maliyatPercent:0,bid:{maliyatafzode:0},desSubmit:{id:"",des:""},sumSelected:0,sumTax:0,sumTotal:0,itemsSelected:[],items:[],headers:[{text:"کالا",value:"commodity.name"},{text:"شرح",value:"des"},{text:"تعداد/مقدار",value:"count"},{text:"مبلغ واحد",value:"price"},{text:"تخفیف",value:"discount"},{text:"مالیات",value:"tax"},{text:"جمع بدون مالیات",value:"sumWithoutTax"},{text:"مبلغ کل",value:"sumTotal"},{text:"عملیات",value:"operation"}],selectedPersonWithDet:{},loading:!1,canSubmit:!0,updateID:null,sum:0,balance:0,currencyConfig:{masked:!1,prefix:"",suffix:"ریال",thousands:",",decimal:".",precision:0,disableNegative:!0,disabled:!1,min:0,max:null,allowBlank:!1,minimumNumberOfCharacters:1,shouldRound:!1,focusOnRight:!0},unitConfig:{masked:!1,prefix:"",suffix:"",thousands:",",decimal:".",precision:0,disableNegative:!0,disabled:!1,allowBlank:!1,shouldRound:!1,focusOnRight:!0},data:{date:"",des:"",person:"",transferCost:0,discountAll:0,pair_docs:[]},year:{},persons:[],commodity:[],units:[],itemData:{id:0,commodity:{unit:"",unitData:{name:"",floatNumber:0}},count:0,price:0,sumTotal:0,sumWithoutTax:0,tax:0,des:"",discount:0},editItemData:{index:0,id:0,commodity:{unit:"",unitData:{name:"",floatNumber:0}},count:0,price:0,sumTotal:0,sumWithoutTax:0,tax:0,des:"",discount:0},sms:!1}),watch:{"editItemData.price":function(){this.editCalc()},"editItemData.discount":function(){this.editCalc()},"editItemData.count":function(){this.editCalc()},"editItemData.commodity":function(e,t){e!=""&&e!=null&&(this.unitConfig.precision=this.editItemData.commodity.unitData.floatNumber,this.editItemData.des=this.editItemData.commodity.des)},"desSubmit.id":function(){this.data.des=this.desSubmit.des},"itemData.price":function(){this.calc()},"itemData.discount":function(){this.calc()},maliyatCheck:function(e){e===!1?this.maliyatPercent=0:this.maliyatPercent=this.bid.maliyatafzode},maliyatPercent:function(e){this.maliyatPercent==""&&(this.maliyatPercent=0),this.items.forEach((t,n)=>{t.sumWithoutTax=t.price*t.count-t.discount,t.tax=(t.price*t.count-t.discount)*e/100,t.sumTotal=(parseFloat(t.price)*parseFloat(t.count)-parseFloat(t.discount))*(100+parseFloat(this.maliyatPercent))/100})},"itemData.count":function(){this.calc()},"itemData.commodity":function(e,t){e!=""&&e!=null&&(this.selectedPriceList.id==0?this.itemData.price=this.itemData.commodity.priceSell:Array.from(this.itemData.commodity.prices).forEach(v=>{v.list.id==this.selectedPriceList.id&&(this.itemData.price=v.priceSell)}),this.unitConfig.precision=this.itemData.commodity.unitData.floatNumber,this.itemData.des=this.itemData.commodity.des)},itemsSelected:{handler:function(e,t){this.sumSelected=0,this.itemsSelected.forEach(n=>{this.sumSelected+=parseFloat(n.sumTotal)})},deep:!0},selectedPriceList:{handler:function(e,t){this.selectedPriceList.id==0?this.itemData.price=this.itemData.commodity.priceSell:Array.from(this.itemData.commodity.prices).forEach(v=>{v.list.id==this.selectedPriceList.id&&(this.itemData.price=v.priceSell)})},deep:!0},items:{handler:function(e,t){this.calcInvoice()},deep:!0},"data.transferCost":{handler:function(e,t){this.calcInvoice()},deep:!1},"data.pair_docs":{handler:function(e,t){this.pair_docs=[],this.data.pair_docs.forEach(n=>{this.buyDocs.forEach(v=>{n==v.code&&this.pair_docs.push(v)})})},deep:!1},"data.discountAll":{handler:function(e,t){this.calcInvoice()},deep:!1},"data.person":{handler:function(e,t){c.post("/api/person/info/"+this.data.person.code).then(n=>{this.selectedPersonWithDet=n.data})},deep:!0}},mounted(){},beforeMount(){this.loadData()},beforeRouteUpdate(e,t){this.loadData(e.params.id)},methods:{test(e){alert()},isPluginActive(e){return this.plugins[e]!==void 0},searchPerson(e,t){t(!0),c.post("/api/person/list/search",{search:e}).then(n=>{this.persons=n.data,t(!1)})},searchCommodity(e,t){t(!0),c.post("/api/commodity/list/search",{search:e}).then(n=>{this.commodity=n.data,t(!1)})},editItem(e){this.editItemData={...this.items[e-1]},this.editItemData.index=e},doEditeItem(){this.editItemData.count==0?m.fire({text:"تعداد صفر نامعتبر است.",icon:"error",confirmButtonText:"قبول"}):this.editItemData.price==0?m.fire({text:"قیمت صفر نامعتبر است.",icon:"error",confirmButtonText:"قبول"}):this.editItemData.commodity==""||this.editItemData.commodity==null?m.fire({text:"کالایی انتخاب نشده است.",icon:"error",confirmButtonText:"قبول"}):this.editItemData.sumTotal==0?m.fire({text:"جمع کل صفر شده است.",icon:"error",confirmButtonText:"قبول"}):(this.items[this.editItemData.index-1]=this.editItemData,m.fire({text:"آیتم فاکتور ویرایش شد.",icon:"success",confirmButtonText:"قبول"}))},calc(){this.itemData.sumWithoutTax=this.itemData.price*this.itemData.count-this.itemData.discount,this.itemData.commodity.withoutTax?(this.itemData.tax=0,this.itemData.sumTotal=parseFloat(this.itemData.price)*parseFloat(this.itemData.count)-parseFloat(this.itemData.discount)):(this.itemData.tax=(this.itemData.price*this.itemData.count-this.itemData.discount)*this.maliyatPercent/100,this.itemData.sumTotal=(parseFloat(this.itemData.price)*parseFloat(this.itemData.count)-parseFloat(this.itemData.discount))*(100+parseFloat(this.maliyatPercent))/100)},editCalc(){this.editItemData.sumWithoutTax=this.editItemData.price*this.editItemData.count-this.editItemData.discount,this.editItemData.commodity.withoutTax?(this.editItemData.tax=0,this.editItemData.sumTotal=parseFloat(this.editItemData.price)*parseFloat(this.editItemData.count)-parseFloat(this.editItemData.discount)):(this.editItemData.tax=(this.editItemData.price*this.editItemData.count-this.editItemData.discount)*this.maliyatPercent/100,this.editItemData.sumTotal=(parseFloat(this.editItemData.price)*parseFloat(this.editItemData.count)-parseFloat(this.editItemData.discount))*(100+parseFloat(this.maliyatPercent))/100)},calcInvoice(){this.sumTotal=0,this.sumTax=0,this.items.forEach(e=>{this.sumTotal+=parseFloat(e.sumTotal),e.commodity.withoutTax==!0?e.tax=0:this.sumTax+=parseFloat(e.tax)}),this.sumTotal+=this.data.transferCost,this.sumTotal-=this.data.discountAll},addItem(){this.itemData.count==0?m.fire({text:"تعداد صفر نامعتبر است.",icon:"error",confirmButtonText:"قبول"}):this.itemData.price==0?m.fire({text:"قیمت صفر نامعتبر است.",icon:"error",confirmButtonText:"قبول"}):this.itemData.commodity==""||this.itemData.commodity==null?m.fire({text:"کالایی انتخاب نشده است.",icon:"error",confirmButtonText:"قبول"}):this.itemData.sumTotal==0?m.fire({text:"جمع کل صفر شده است.",icon:"error",confirmButtonText:"قبول"}):(this.items.push(this.itemData),this.itemData={id:0,commodity:this.commodity[0],count:0,price:0,sumTotal:0,sumWithoutTax:0,tax:0,des:"",discount:0},m.fire({text:"آیتم به فاکتور افزوده شد.",icon:"success",confirmButtonText:"قبول"}))},deleteItem(e){m.fire({text:"آیا برای حذف این مورد مطمئن هستید؟",showCancelButton:!0,confirmButtonText:"بله",cancelButtonText:"خیر"}).then(t=>{t.isConfirmed&&this.items.splice(e-1,1)})},loadData(){this.loading=!0,c.post("/api/commodity/pricelist/list").then(e=>{this.priceList=e.data,this.priceList.push({id:0,label:"پیشفرض"})}),c.post("/api/year/get").then(e=>{this.year=e.data,this.data.date=e.data.now}),c.post("/api/business/get/info/"+localStorage.getItem("activeBid")).then(e=>{this.bid=e.data,this.bid.maliyatafzode==0&&(this.maliyatCheck=!1),this.maliyatPercent=this.bid.maliyatafzode,this.loading=!1}),c.post("/api/person/list/search").then(e=>{this.persons=e.data}),c.post("/api/commodity/list/search").then(e=>{this.commodity=e.data,e.data.length!=0?this.itemData.commodity=e.data[0]:m.fire({text:"برای ثبت فاکتور ابتدا یک کالای جدید تعریف کنید.",icon:"warning",confirmButtonText:"تعریف کالای جدید"})}),c.post("/api/commodity/units").then(e=>{this.units=e.data}),c.post("/api/plugin/get/actives").then(e=>{this.plugins=e.data}),c.post("/api/sms/load/settings").then(e=>{this.sms=e.data.sendAfterSell}),c.post("/api/buy/docs/search",{type:"buy"}).then(e=>{this.buyDocs=e.data,this.$route.params.id!=""&&c.post("/api/sell/get/info/"+this.$route.params.id).then(t=>{this.data.date=t.data.date,this.data.des=t.data.des,this.data.person=t.data.person,this.data.transferCost=t.data.transferCost,this.data.discountAll=t.data.discountAll,this.data.pair_docs=t.data.pair_docs,t.data.rows.forEach((n,v)=>{n.commodity!=null&&this.items.push({commodity:n.commodity,count:n.commodity_count,price:parseInt((parseInt(n.bs)-parseInt(n.tax)+parseInt(n.discount))/parseInt(n.commodity_count)),bs:n.bs,bd:n.bd,type:"commodity",id:n.commodity.id,des:n.des,discount:n.discount,tax:n.tax,sumWithoutTax:n.bs-n.tax,sumTotal:n.bs,table:53})})}),this.loading=!1})},save(){this.canSubmit=!1,this.items.length==0?m.fire({text:"فاکتور فاقد کالا می باشد.",icon:"warning",confirmButtonText:"قبول"}):this.data.person==null||this.data.person==""?m.fire({text:"طرف حساب انتخاب نشده است.",icon:"warning",confirmButtonText:"قبول"}):(this.loading=!0,c.post("/api/sell/mod",{type:"sell",date:this.data.date,des:this.data.des,person:this.data.person,rows:this.items,discountAll:this.data.discountAll,transferCost:this.data.transferCost,update:this.$route.params.id,sms:this.sms,pair_docs:this.data.pair_docs}).then(e=>{this.loading=!1,e.data.code==0?m.fire({text:"فاکتور ثبت شد.",icon:"success",confirmButtonText:"قبول"}).then(()=>{this.$router.push("/acc/sell/list")}):e.data.result==1?m.fire({text:"فاکتور ثبت و پیامک اطلاع رسانی به مشتری ارسال شد.",icon:"success",confirmButtonText:"قبول"}).then(()=>{this.$router.push("/acc/sell/list")}):e.data.result==2?m.fire({text:"فاکتور ثبت ولی به دلیل کمبود اعتبار پیامک اطلاع رسانی به مشتری ارسال نشد..",icon:"success",confirmButtonText:"قبول"}).then(()=>{this.$router.push("/acc/sell/list")}):m.fire({text:e.data.message,icon:"error",confirmButtonText:"قبول"})}).catch(e=>{this.loading=!1,m.fire({text:"اتصال با سرویس دهنده برقرار نشد. لطفا اتصال اینترنت خود را بررسی نمایید.",icon:"error",confirmButtonText:"قبول"})})),this.canSubmit=!0}}},rt={class:"row"},mt={class:"col-sm-12 col-md-6 mb-1"},ct={class:"block block-rounded border"},ut={class:"block-content pt-1 px-1"},pt={class:"col-sm-12 col-md-6 mb-1"},ft={class:"block block-rounded border"},ht={class:"block-header block-header-default py-1"},bt={class:"block-options"},vt={class:"block-content pt-1 px-1"},yt={class:"row mb-1"},gt={class:"col-12"},Dt={class:"col-12"},_t={class:"row"},kt={class:"col-6"},It={class:"col-6"},Vt={key:0,class:"text-danger"},xt={key:1,class:"text-success"},Tt={key:0,class:"text-info ms-2"},Ct={key:0,class:"text-danger"},wt={key:1,class:"text-success"},$t={class:"col-sm-12 col-md-12 mb-1"},Pt={class:"block block-rounded border"},St={class:"block-header block-header-default py-1"},Bt={class:"block-options"},Ut={class:"block-content p-0"},Mt={class:"row"},Nt={class:"col-12"},Wt={class:"container"},At={class:"row"},Ft={class:"col-sm-12 col-md-6 mb-0"},Lt={class:"block block-rounded border"},Et={class:"block-header block-header-default py-1"},qt={class:"block-options"},zt={class:"block-content pt-1 px-1"},Yt={class:"row mb-1"},jt={class:"col-12"},Rt={class:"col-12"},Ot={key:0},Gt={style:{direction:"ltr"}},Ht={class:"col-sm-12 col-md-6 mb-2"},Jt={class:"block block-rounded border"},Kt={class:"block-content p-0"},Qt={class:"col-sm-12 col-md-6 mb-2"},Xt={class:"form-floating mb-3"},Zt={key:0,for:"floatingInput"},te={class:"col-sm-12 col-md-6 mb-2"},ee={class:"input-group mb-3"},se={class:"form-floating mb-3"},oe={class:"col-sm-12 col-md-6 mb-2"},ae={class:"form-floating mb-3"},ie={class:"col-sm-12 col-md-6 mb-2"},le={class:"form-floating mb-3"},de={class:"row pa-2"},ne={class:"col-sm-12 col-md-6 mb-0"},re={class:"block block-rounded border"},me={class:"block-header block-header-default py-1"},ce={class:"block-options"},ue={class:"block-content pt-1 px-1"},pe={class:"row mb-1"},fe={class:"col-12"},he={class:"col-12"},be={key:0},ve={style:{direction:"ltr"}},ye={class:"col-sm-12 col-md-6 mb-2"},ge={class:"block block-rounded border"},De={class:"block-content p-0"},_e={class:"col-sm-12 col-md-6 mb-2"},ke={class:"form-floating mb-3"},Ie={key:0,for:"floatingInput"},Ve={class:"col-sm-12 col-md-6 mb-2"},xe={class:"input-group mb-3"},Te={class:"form-floating mb-3"},Ce={class:"col-sm-12 col-md-6 mb-2"},we={class:"form-floating mb-3"},$e={class:"col-sm-12 col-md-6 mb-2"},Pe={class:"form-floating mb-3"},Se=["onClick"],Be=["onClick"],Ue={class:"row mt-2"},Me={class:"col-sm-12 col-md-4"},Ne={class:"input-group input-group-sm mb-2"},We={class:"input-group-text",id:"inputGroup-sizing-sm"},Ae={class:"col-sm-12 col-md-4"},Fe={class:"input-group input-group-sm mb-2"},Le={class:"col-sm-12 col-md-4"},Ee={class:"input-group input-group-sm mb-2"},qe={class:"container-fluid p-0 mx-0 mt-2"},ze={class:"block block-rounded block-link-shadow border-start border-success border-3",href:"javascript:void(0)"},Ye={class:"block-content block-content-full block-content-sm bg-body-light"},je={class:"row"},Re={class:"col-sm-12 col-md-3"},Oe={class:"text-primary"},Ge={class:"col-sm-12 col-md-3"},He={class:"text-primary"},Je={class:"col-sm-12 col-md-3"},Ke={class:"text-primary"},Qe={class:"col-sm-12 col-md-3"},Xe={class:"text-primary"},Ze={class:"bg-gray"},ts={class:"text-center"},es={class:"text-center"},ss={class:"text-center"},os={class:"text-center"},as={class:"text-center"},is={class:"text-center"};function ls(e,t,n,v,ds,g){const D=r("v-btn"),_=r("v-tooltip"),T=r("v-spacer"),L=r("v-switch"),I=r("v-icon"),C=r("v-tab"),E=r("v-tabs"),w=r("v-toolbar"),q=r("date-picker"),z=r("quickView"),Y=r("quickAdd"),$=r("v-cob"),j=r("mostdes"),P=r("v-card-text"),k=r("v-card"),S=r("v-tabs-window-item"),M=r("quickAddCommodity"),b=r("money3"),N=r("v-col"),W=r("v-row"),A=r("v-bottom-sheet"),R=r("EasyDataTable"),O=r("v-alert"),G=r("v-list-item"),H=r("v-autocomplete"),J=r("RouterLink"),K=r("v-chip"),Q=r("v-table"),X=r("v-tabs-window");return u(),h(B,null,[a(w,{color:"toolbar",title:e.$t("dialog.sell_invoice")},{prepend:i(()=>[a(_,{text:e.$t("dialog.back"),location:"bottom"},{activator:i(({props:o})=>[a(D,p(o,{onClick:t[0]||(t[0]=f=>e.$router.back()),class:"d-none d-sm-flex",variant:"text",icon:"mdi-arrow-right"}),null,16)]),_:1},8,["text"])]),extension:i(()=>[a(E,{color:"primary",class:"bg-light",grow:"",modelValue:e.tabs,"onUpdate:modelValue":t[3]||(t[3]=o=>e.tabs=o)},{default:i(()=>[a(C,{value:"0"},{default:i(()=>[d(l(e.$t("dialog.invoice_info")),1)]),_:1}),a(C,{value:"1"},{default:i(()=>[d(l(e.$t("dialog.comsofinvoice")),1)]),_:1}),a(C,{value:"2"},{default:i(()=>[d(l(e.$t("dialog.pair_docs")),1)]),_:1})]),_:1},8,["modelValue"])]),default:i(()=>[a(T),a(L,{disabled:this.selectedPersonWithDet.mobile==""||this.selectedPersonWithDet.mobile==null,modelValue:e.sms,"onUpdate:modelValue":t[1]||(t[1]=o=>e.sms=o),label:e.$t("dialog.sms"),color:"primary","hide-details":"true"},null,8,["disabled","modelValue","label"]),a(D,{disabled:this.canSubmit!=!0,onClick:t[2]||(t[2]=o=>g.save()),loading:e.loading,icon:"",color:"green"},{default:i(()=>[a(_,{activator:"parent",text:e.$t("dialog.save"),location:"bottom"},null,8,["text"]),a(I,{icon:"mdi-content-save"})]),_:1},8,["disabled","loading"])]),_:1},8,["title"]),a(W,{class:"pa-1"},{default:i(()=>[a(N,null,{default:i(()=>[a(X,{modelValue:e.tabs,"onUpdate:modelValue":t[31]||(t[31]=o=>e.tabs=o)},{default:i(()=>[a(S,{value:"0"},{default:i(()=>[a(k,null,{default:i(()=>[a(P,null,{default:i(()=>[s("div",rt,[s("div",mt,[s("div",ct,[t[32]||(t[32]=s("div",{class:"block-header block-header-default py-1"},[s("h3",{class:"block-title text-primary"},[s("i",{class:"fa fa-calendar"}),d(" تاریخ ")]),s("div",{class:"block-options"})],-1)),s("div",ut,[s("p",null,[a(q,{class:"",modelValue:e.data.date,"onUpdate:modelValue":t[4]||(t[4]=o=>e.data.date=o),format:"jYYYY/jMM/jDD","display-format":"jYYYY/jMM/jDD",min:e.year.start,max:e.year.end},null,8,["modelValue","min","max"])])])])]),s("div",pt,[s("div",ft,[s("div",ht,[t[33]||(t[33]=s("h3",{class:"block-title text-primary"},[s("i",{class:"fa fa-person"}),d(" طرف حساب ")],-1)),s("div",bt,[a(z,{code:this.data.person.code},null,8,["code"]),a(Y,{code:this.data.person.code},null,8,["code"])])]),s("div",vt,[a($,{class:"mb-1 mx-0",filterable:!1,dir:"rtl",onSearch:g.searchPerson,options:e.persons,label:"nikename",modelValue:e.data.person,"onUpdate:modelValue":t[5]||(t[5]=o=>e.data.person=o)},{"no-options":i(({search:o,searching:f,loading:V})=>t[34]||(t[34]=[d(" نتیجه‌ای یافت نشد! ")])),option:i(o=>[s("div",yt,[s("div",gt,[t[35]||(t[35]=s("i",{class:"fa fa-user me-2"},null,-1)),d(" "+l(o.nikename),1)]),s("div",Dt,[s("div",_t,[s("div",kt,[t[36]||(t[36]=s("i",{class:"fa fa-phone me-2"},null,-1)),d(" "+l(o.mobile),1)]),s("div",It,[t[37]||(t[37]=s("i",{class:"fa fa-bars"},null,-1)),d(" تراز: "+l(e.$filters.formatNumber(Math.abs(parseInt(o.bs)-parseInt(o.bd))))+" ",1),parseInt(o.bs)-parseInt(o.bd)<0?(u(),h("span",Vt," بدهکار ")):y("",!0),parseInt(o.bs)-parseInt(o.bd)>0?(u(),h("span",xt," بستانکار ")):y("",!0)])])])])]),_:1},8,["onSearch","options","modelValue"]),e.selectedPersonWithDet.bs!=null?(u(),h("span",Tt,[d(" تراز: "+l(e.$filters.formatNumber(Math.abs(parseInt(this.selectedPersonWithDet.bs)-parseInt(this.selectedPersonWithDet.bd))))+" ",1),parseInt(this.selectedPersonWithDet.bs)-parseInt(this.selectedPersonWithDet.bd)<0?(u(),h("span",Ct," بدهکار ")):y("",!0),parseInt(this.selectedPersonWithDet.bs)-parseInt(this.selectedPersonWithDet.bd)>0?(u(),h("span",wt," بستانکار ")):y("",!0)])):y("",!0)])])]),s("div",$t,[s("div",Pt,[s("div",St,[t[38]||(t[38]=s("h3",{class:"block-title text-primary"},[s("i",{class:"fa-regular fa-note-sticky"}),d(" شرح ")],-1)),s("div",Bt,[a(j,{submitData:e.desSubmit,type:"sell"},null,8,["submitData"])])]),s("div",Ut,[x(s("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>e.data.des=o),class:"form-control",type:"text"},null,512),[[U,e.data.des]])])])])])]),_:1})]),_:1})]),_:1}),a(S,{value:"1"},{default:i(()=>[a(k,null,{default:i(()=>[a(P,null,{default:i(()=>[s("div",Mt,[s("div",Nt,[a(A,{fullscreen:"",inset:"",class:"float-start",modelValue:e.addsheet,"onUpdate:modelValue":t[15]||(t[15]=o=>e.addsheet=o)},{activator:i(({props:o})=>[a(D,p(o,{color:"primary",class:""}),{default:i(()=>[a(I,null,{default:i(()=>t[39]||(t[39]=[d("mdi-plus")])),_:1}),d(" "+l(e.$t("dialog.add_row")),1)]),_:2},1040)]),default:i(()=>[a(k,{class:"bg-white",loading:e.loading},{default:i(()=>[a(w,{color:"toolbar",title:e.$t("drawer.commodity")},{prepend:i(()=>[a(_,{text:e.$t("dialog.back"),location:"bottom"},{activator:i(({props:o})=>[a(D,{icon:"mdi-close",onClick:t[7]||(t[7]=f=>e.addsheet=!e.addsheet)})]),_:1},8,["text"])]),default:i(()=>[a(T),a(D,{loading:e.loading,onClick:t[8]||(t[8]=o=>g.addItem()),icon:"",color:"green"},{default:i(()=>[a(_,{activator:"parent",text:e.$t("dialog.save"),location:"bottom"},null,8,["text"]),a(I,{icon:"mdi-content-save"})]),_:1},8,["loading"])]),_:1},8,["title"]),a(W,{class:"pa-2 my-auto"},{default:i(()=>[a(N,{cols:"12",sm:"12",md:"12"},{default:i(()=>[s("div",Wt,[s("div",At,[s("div",Ft,[s("div",Lt,[s("div",Et,[t[40]||(t[40]=s("h3",{class:"block-title text-primary"},[s("i",{class:"fa fa-box pe-2"}),d(" کالا و خدمات ")],-1)),s("div",qt,[a(M)])]),s("div",zt,[a($,{dir:"rtl",onSearch:g.searchCommodity,options:e.commodity,label:"name",modelValue:e.itemData.commodity,"onUpdate:modelValue":t[9]||(t[9]=o=>e.itemData.commodity=o),class:""},{"no-options":i(({search:o,searching:f,loading:V})=>t[41]||(t[41]=[d(" نتیجه‌ای یافت نشد! ")])),option:i(o=>[s("div",Yt,[s("div",jt,[t[42]||(t[42]=s("i",{class:"fa fa-box me-1"},null,-1)),d(" "+l(o.name),1)]),s("div",Rt,[o.khadamat==!1?(u(),h("small",Ot,[t[43]||(t[43]=s("i",{class:"fa fa-store me-1"},null,-1)),t[44]||(t[44]=s("small",{class:"text-danger"}," موجودی: ",-1)),s("label",Gt,l(o.count),1),d(" "+l(o.unit),1)])):y("",!0)])])]),_:1},8,["onSearch","options","modelValue"])])])]),s("div",Ht,[s("div",Jt,[t[45]||(t[45]=s("div",{class:"block-header block-header-default py-1"},[s("h3",{class:"block-title text-primary"},[s("i",{class:"fa-regular fa-note-sticky"}),d(" شرح ")]),s("div",{class:"block-options"})],-1)),s("div",Kt,[x(s("input",{"onUpdate:modelValue":t[10]||(t[10]=o=>this.itemData.des=o),class:"form-control",type:"text"},null,512),[[U,this.itemData.des]])])])]),s("div",Qt,[s("div",Xt,[a(b,p(e.unitConfig,{class:"form-control",modelValue:this.itemData.count,"onUpdate:modelValue":t[11]||(t[11]=o=>this.itemData.count=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),e.itemData.commodity?(u(),h("label",Zt,l(e.itemData.commodity.unitData.name),1)):y("",!0)])]),s("div",te,[s("div",ee,[s("div",se,[a(b,p(e.currencyConfig,{min:"0",class:"form-control",modelValue:this.itemData.price,"onUpdate:modelValue":t[12]||(t[12]=o=>this.itemData.price=o)}),null,16,["modelValue"]),t[46]||(t[46]=s("label",{for:"floatingInput"},"قیمت واحد",-1))])])]),s("div",oe,[s("div",ae,[a(b,p(e.currencyConfig,{class:"form-control",modelValue:this.itemData.discount,"onUpdate:modelValue":t[13]||(t[13]=o=>this.itemData.discount=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),t[47]||(t[47]=s("label",{for:"floatingInput"},"تخفیف",-1))])]),s("div",ie,[s("div",le,[a(b,p({readonly:"readonly"},e.currencyConfig,{class:"form-control",modelValue:this.itemData.sumWithoutTax,"onUpdate:modelValue":t[14]||(t[14]=o=>this.itemData.sumWithoutTax=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),t[48]||(t[48]=s("label",{for:"floatingInput"},"قیمت کل",-1))])])])])]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1},8,["modelValue"]),a(A,{fullscreen:"",inset:"",class:"float-start",modelValue:e.editsheet,"onUpdate:modelValue":t[24]||(t[24]=o=>e.editsheet=o)},{default:i(()=>[a(k,{class:"bg-white",loading:e.loading},{default:i(()=>[a(w,{color:"toolbar",title:e.$t("drawer.commodity")},{prepend:i(()=>[a(_,{text:e.$t("dialog.back"),location:"bottom"},{activator:i(({props:o})=>[a(D,{icon:"mdi-close",onClick:t[16]||(t[16]=f=>e.editsheet=!e.editsheet)})]),_:1},8,["text"])]),default:i(()=>[a(T),a(D,{loading:e.loading,onClick:t[17]||(t[17]=o=>g.doEditeItem()),icon:"",color:"green"},{default:i(()=>[a(_,{activator:"parent",text:e.$t("dialog.save"),location:"bottom"},null,8,["text"]),a(I,{icon:"mdi-content-save"})]),_:1},8,["loading"])]),_:1},8,["title"]),s("div",de,[s("div",ne,[s("div",re,[s("div",me,[t[49]||(t[49]=s("h3",{class:"block-title text-primary"},[s("i",{class:"fa fa-box pe-2"}),d(" کالا و خدمات ")],-1)),s("div",ce,[a(M)])]),s("div",ue,[a($,{dir:"rtl",onSearch:g.searchCommodity,options:e.commodity,label:"name",modelValue:e.editItemData.commodity,"onUpdate:modelValue":t[18]||(t[18]=o=>e.editItemData.commodity=o),class:""},{"no-options":i(({search:o,searching:f,loading:V})=>t[50]||(t[50]=[d(" نتیجه‌ای یافت نشد! ")])),option:i(o=>[s("div",pe,[s("div",fe,[t[51]||(t[51]=s("i",{class:"fa fa-box me-1"},null,-1)),d(" "+l(o.name),1)]),s("div",he,[o.khadamat==!1?(u(),h("small",be,[t[52]||(t[52]=s("i",{class:"fa fa-store me-1"},null,-1)),t[53]||(t[53]=s("small",{class:"text-danger"}," موجودی: ",-1)),s("label",ve,l(o.count),1),d(" "+l(o.unit),1)])):y("",!0)])])]),_:1},8,["onSearch","options","modelValue"])])])]),s("div",ye,[s("div",ge,[t[54]||(t[54]=s("div",{class:"block-header block-header-default py-1"},[s("h3",{class:"block-title text-primary"},[s("i",{class:"fa-regular fa-note-sticky"}),d(" شرح ")]),s("div",{class:"block-options"})],-1)),s("div",De,[x(s("input",{"onUpdate:modelValue":t[19]||(t[19]=o=>this.editItemData.des=o),class:"form-control",type:"text"},null,512),[[U,this.editItemData.des]])])])]),s("div",_e,[s("div",ke,[a(b,p(e.unitConfig,{class:"form-control",modelValue:this.editItemData.count,"onUpdate:modelValue":t[20]||(t[20]=o=>this.editItemData.count=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),e.editItemData.commodity?(u(),h("label",Ie,l(e.editItemData.commodity.unitData.name),1)):y("",!0)])]),s("div",Ve,[s("div",xe,[s("div",Te,[a(b,p(e.currencyConfig,{min:"0",class:"form-control",modelValue:this.editItemData.price,"onUpdate:modelValue":t[21]||(t[21]=o=>this.editItemData.price=o)}),null,16,["modelValue"]),t[55]||(t[55]=s("label",{for:"floatingInput"},"قیمت واحد",-1))])])]),s("div",Ce,[s("div",we,[a(b,p(e.currencyConfig,{class:"form-control",modelValue:this.editItemData.discount,"onUpdate:modelValue":t[22]||(t[22]=o=>this.editItemData.discount=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),t[56]||(t[56]=s("label",{for:"floatingInput"},"تخفیف",-1))])]),s("div",$e,[s("div",Pe,[a(b,p({readonly:"readonly"},e.currencyConfig,{class:"form-control",modelValue:this.editItemData.sumWithoutTax,"onUpdate:modelValue":t[23]||(t[23]=o=>this.editItemData.sumWithoutTax=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),t[57]||(t[57]=s("label",{for:"floatingInput"},"قیمت کل",-1))])])])]),_:1},8,["loading"])]),_:1},8,["modelValue"]),a(R,{"table-class-name":"customize-table",class:"mt-3","items-selected":e.itemsSelected,"onUpdate:itemsSelected":t[25]||(t[25]=o=>e.itemsSelected=o),"show-index":"",alternating:"",headers:e.headers,items:e.items,"theme-color":"#1d90ff","header-text-direction":"center","body-text-direction":"center",rowsPerPageMessage:"تعداد سطر",emptyMessage:"هیچ آیتمی به این فاکتور افزوده نشده است.",rowsOfPageSeparatorMessage:"از"},{"item-operation":i(({index:o})=>[s("button",{title:"حذف",class:"btn btn-sm text-danger px-1",onClick:f=>g.deleteItem(o)},t[58]||(t[58]=[s("i",{class:"fa fa-trash"},null,-1)]),8,Se),s("button",{title:"ویرایش",class:"btn btn-sm text-info px-1",onClick:f=>{g.editItem(o),e.editsheet=!0}},t[59]||(t[59]=[s("i",{class:"fa fa-edit"},null,-1)]),8,Be)]),"item-sumTotal":i(({sumTotal:o})=>[d(l(e.$filters.formatNumber(o)),1)]),"item-sumWithoutTax":i(({sumWithoutTax:o})=>[d(l(e.$filters.formatNumber(o)),1)]),"item-price":i(({price:o})=>[d(l(e.$filters.formatNumber(o)),1)]),"item-commodity.name":i(({commodity:o})=>[d(l(o.code)+" - "+l(o.name),1)]),"item-tax":i(({tax:o})=>[d(l(e.$filters.formatNumber(o)),1)]),"item-discount":i(({discount:o})=>[d(l(e.$filters.formatNumber(o)),1)]),"item-count":i(({count:o,commodity:f})=>[d(l(o)+" "+l(f.unit),1)]),_:1},8,["items-selected","headers","items"]),s("div",Ue,[s("div",Me,[s("div",Ne,[s("span",We,[x(s("input",{"onUpdate:modelValue":t[26]||(t[26]=o=>e.maliyatCheck=o),class:"form-check-input mt-0 me-2",type:"checkbox","aria-label":"Checkbox for following text input"},null,512),[[st,e.maliyatCheck]]),t[60]||(t[60]=d(" مالیات % "))]),a(b,p({disabled:!e.maliyatCheck},e.unitConfig,{"aria-label":"مالیات بر ارزش افزوده",class:"form-control",modelValue:e.maliyatPercent,"onUpdate:modelValue":t[27]||(t[27]=o=>e.maliyatPercent=o),modelModifiers:{number:!0}}),null,16,["disabled","modelValue"])])]),s("div",Ae,[s("div",Fe,[t[61]||(t[61]=s("span",{class:"input-group-text",id:"inputGroup-sizing-sm"}," تخفیف ",-1)),a(b,p(e.currencyConfig,{"aria-label":"تخفیف روی فاکتور",class:"form-control",modelValue:e.data.discountAll,"onUpdate:modelValue":t[28]||(t[28]=o=>e.data.discountAll=o),modelModifiers:{number:!0}}),null,16,["modelValue"])])]),s("div",Le,[s("div",Ee,[t[62]||(t[62]=s("span",{class:"input-group-text",id:"inputGroup-sizing-sm"}," حمل و نقل ",-1)),a(b,p(e.currencyConfig,{"aria-label":"مالیات بر ارزش افزوده",class:"form-control",modelValue:e.data.transferCost,"onUpdate:modelValue":t[29]||(t[29]=o=>e.data.transferCost=o),modelModifiers:{number:!0}}),null,16,["modelValue"])])])]),s("div",qe,[s("a",ze,[s("div",Ye,[s("div",je,[s("div",Re,[t[63]||(t[63]=s("span",{class:"text-dark"},[s("i",{class:"fa fa-list-dots"}),d(" اقلام فاکتور: ")],-1)),s("span",Oe,l(e.items.length)+" قلم ",1)]),s("div",Ge,[t[64]||(t[64]=s("span",{class:"text-dark"},[s("i",{class:"fa fa-list-dots"}),d(" مالیات: ")],-1)),s("span",He,l(e.$filters.formatNumber(this.sumTax))+" "+l(e.$filters.getActiveMoney().shortName),1)]),s("div",Je,[t[65]||(t[65]=s("span",{class:"text-dark"},[s("i",{class:"fa fa-list-check"}),d(" جمع مبلغ موارد انتخابی: ")],-1)),s("span",Ke,l(e.$filters.formatNumber(this.sumSelected))+" "+l(e.$filters.getActiveMoney().shortName),1)]),s("div",Qe,[t[66]||(t[66]=s("span",{class:"text-dark"},[s("i",{class:"fa fa-list-dots"}),d(" جمع کل: ")],-1)),s("span",Xe,l(e.$filters.formatNumber(this.sumTotal))+" "+l(e.$filters.getActiveMoney().shortName),1)])])])])])])])]),_:1})]),_:1})]),_:1}),a(S,{value:"2"},{default:i(()=>[a(k,null,{default:i(()=>[a(P,null,{default:i(()=>[a(O,{color:"info",icon:"mdi-information-box",text:e.$t("info.sell_pairdocs"),variant:"tonal"},null,8,["text"]),a(H,{loading:e.loading,"prepend-inner-icon":"mdi-file-search",class:"mt-2","hide-details":"auto",chips:"","closable-chips":"",multiple:"",label:e.$t("dialog.search_invoice"),modelValue:e.data.pair_docs,"onUpdate:modelValue":t[30]||(t[30]=o=>e.data.pair_docs=o),items:e.buyDocs,"item-title":"code","item-value":"code"},{item:i(({props:o,item:f})=>[a(G,p(o,{title:f.title}),null,16,["title"])]),_:1},8,["loading","label","modelValue","items"]),a(Q,{density:"compact",class:"border"},{default:i(()=>[s("thead",Ze,[s("tr",null,[s("th",ts,l(e.$t("dialog.row")),1),s("th",es,l(e.$t("dialog.invoice_num")),1),s("th",ss,l(e.$t("dialog.date")),1),s("th",os,l(e.$t("dialog.suplayer")),1),s("th",as,l(e.$t("dialog.commodities")),1),s("th",is,l(e.$t("dialog.amount")),1)])]),s("tbody",null,[(u(!0),h(B,null,F(e.pair_docs,(o,f)=>(u(),h("tr",{key:o.name,class:"text-center"},[s("td",null,l(f),1),s("td",null,[a(J,{to:"/acc/sell/mod/"+o.code},{default:i(()=>[d(l(o.code),1)]),_:2},1032,["to"])]),s("td",null,l(o.date),1),s("td",null,l(o.person.nikename),1),s("td",null,[(u(!0),h(B,null,F(o.commodities,V=>(u(),ot(K,{variant:"tonal",class:"me-1",size:"small",color:"primary"},{default:i(()=>[d(l(V.name),1)]),_:2},1024))),256))]),s("td",null,l(e.$filters.formatNumber(o.amount)),1)]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})],64)}const bs=Z(nt,[["render",ls],["__scopeId","data-v-db9b0757"]]);export{bs as default};
