import{a as p,_ as z}from"./main-9b36f05f.js";import{s as G}from"./send-cfd9dde5.js";import{r as S}from"./recList-3e892c5b.js";import{A as D}from"./archiveUpload-31fb560b.js";import{n as M}from"./notes-77134a25.js";import{h as $,r as V,a as d,o as n,s as l,e as t,u as i,au as L,ao as m,d as r,c as O,A as y,t as e,b as c,B as v,ar as C,ab as a,w as b,F as h,C as U}from"./vendor-adef9cb4.js";const N=$({name:"viewInvoice",components:{ArchiveUpload:D,send:G,recList:S,notes:M},watch:{"PayWindowsState.submited"(o,s){this.PayWindowsState.submited=!1,o&&(this.loadData(),this.recModal.hide())},"recListWindowsState.submited"(o,s){this.recListWindowsState.submited=!1,o&&this.loadData()}},data:()=>({printOptions:{pays:!0,note:!0,bidInfo:!0,taxInfo:!0,discountInfo:!0,paper:"A4-L"},notes:{count:0},PayWindowsState:{submited:!1},recListWindowsState:{submited:!1},recModal:{},recListModal:{},loading:V(!0),shortlink_url:"",copy_label:"کپی",send_message_label:"ارسال",bid:{legal_name:""},item:{doc:{id:0,date:null,code:null,des:"",amount:0},relatedDocs:[],rows:[]},person:{nikename:null,mobile:""},commoditys:[],totalSend:0,totalDiscount:0,totalTax:0,transferCost:0,discountAll:0,mobileHeaders:[{text:"کالا",value:"commodity.name"},{text:"تعداد",value:"count"},{text:"مبلغ کل",value:"sumTotal"}]}),methods:{copyToCliboard(){navigator.clipboard.writeText(this.shortlink_url),this.copy_label="کپی شد !"},loadData(){this.loading=!0,this.commoditys=[],p.post("/api/accounting/doc/get",{code:this.$route.params.id}).then(o=>{this.item=o.data,o.data.relatedDocs.forEach(s=>{this.totalSend+=parseInt(s.amount)})}),p.post("/api/rfsell/get/info/"+this.$route.params.id).then(o=>{this.loading=!1,this.person=o.data.person,this.discountAll=o.data.discountAll,this.transferCost=o.data.transferCost,o.data.rows.forEach(s=>{s.commodity!=null&&(this.totalTax+=parseInt(s.tax),this.totalDiscount+=parseInt(s.discount),this.commoditys.push({commodity:s.commodity,count:s.commodity_count,price:parseInt((parseInt(s.bd)-parseInt(s.tax)+parseInt(s.discount))/parseFloat(s.commodity_count)),bs:s.bs,bd:s.bd,id:s.commodity.id,des:s.des,discount:s.discount,tax:s.tax,sumWithoutTax:s.bd-s.tax,sumTotal:s.bd,table:120}))})}),p.post("/api/business/get/info/"+localStorage.getItem("activeBid")).then(o=>{this.bid=o.data}),p.post("/api/printers/options/info").then(o=>{this.isLoading=!1,this.printOptions=o.data.sell})},printInvoice(o=!0,s=!0){this.loading=!0,p.post("/api/rfsell/print/invoice",{code:this.$route.params.id,pdf:o,printers:s,printOptions:this.printOptions}).then(g=>{this.loading=!1,this.printID=g.data.id,window.open(this.$API_URL+"/front/print/"+this.printID,"_blank","noreferrer")})}},mounted(){this.loadData(),this.recModal=new bootstrap.Modal(document.getElementById("rec-modal")),this.recListModal=new bootstrap.Modal(document.getElementById("rec-list-modal"))}});const T={class:"modal fade",id:"printModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"printModalLabel","aria-hidden":"true"},B={class:"modal-dialog"},P={class:"modal-content"},W={class:"modal-body"},j={class:"form-floating mb-2"},H={class:"form-check form-switch"},R={class:"form-check form-switch"},q={class:"form-check form-switch"},J={class:"form-check form-switch"},K={class:"form-check form-switch"},Q={class:"modal-footer"},X={class:"block block-content-full"},Y={id:"fixed-header",class:"block-header block-header-default bg-gray-light"},Z={class:"block-title text-primary-dark"},tt={class:"block-options"},st={type:"button",class:"btn btn-sm btn-warning text-light me-2","data-bs-toggle":"modal","data-bs-target":"#notesModal"},ot={class:"badge text-bg-dark me-2"},ut={type:"button",class:"btn btn-sm btn-success",disabled:"disabled"},it={class:"modal fade","data-bs-backdrop":"static","data-bs-keyboard":"false",id:"rec-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel1","aria-hidden":"true"},et={class:"modal-dialog modal-lg"},nt={class:"modal-content"},lt={class:"modal-body"},at={class:"modal fade",id:"rec-list-modal",tabindex:"-1","aria-hidden":"true"},dt={class:"modal-dialog modal-lg"},rt={class:"modal-content"},pt={class:"modal-body"},mt={class:"block-content py-2 mt-2"},ct={class:"row"},bt={class:"col-12"},ft={class:"row"},gt={class:"col-sm-6 col-md-4"},yt={class:"input-group input-group-sm mb-3"},vt={class:"col-sm-6 col-md-4"},Ct={class:"input-group input-group-sm mb-3"},ht={class:"col-sm-12 col-md-4"},At={class:"input-group input-group-sm mb-3"},kt={class:"row"},wt={class:"col-sm-6 col-md-4"},xt={class:"input-group input-group-sm mb-3"},_t={class:"col-sm-6 col-md-4"},Et={class:"input-group input-group-sm mb-3"},Ft={class:"col-sm-6 col-md-4"},It={class:"input-group input-group-sm mb-3"},zt={class:"col-sm-6 col-md-3"},Gt={class:"input-group input-group-sm mb-3"},St={class:"col-sm-12 col-md-9"},Dt={class:"input-group input-group-sm mb-3"},Mt={class:"p-1 m-0"},$t={class:"list-group"},Vt={class:"list-group-item d-flex justify-content-between align-items-center"},Lt={class:"badge text-bg-primary rounded-pill"},Ot={class:"list-group-item d-flex justify-content-between align-items-center"},Ut={class:"badge text-bg-primary rounded-pill"},Nt={class:"list-group-item d-flex justify-content-between align-items-center"},Tt={class:"badge text-bg-primary rounded-pill"},Bt={class:"list-group-item d-flex justify-content-between align-items-center"},Pt={class:"row pt-2"},Wt={class:"col-sm-6 col-md-6"},jt={class:"input-group input-group-sm mb-3"},Ht=["value"],Rt={class:"col-sm-6 col-md-6"},qt={class:"input-group input-group-sm mb-3"},Jt={key:0,type:"text",readonly:"readonly",value:"تسویه شده",class:"form-control text-success","aria-describedby":"inputGroup-sizing-sm"},Kt={key:1,type:"text",readonly:"readonly",value:"تسویه نشده",class:"form-control text-danger","aria-describedby":"inputGroup-sizing-sm"},Qt={class:"row"},Xt={class:"col-sm-6 col-md-4"},Yt={class:"input-group input-group-sm mb-3"},Zt=["value"],ts={class:"col-sm-6 col-md-4"},ss={class:"input-group input-group-sm mb-3"},os=["value"],us={class:"col-sm-6 col-md-4"},is={class:"input-group input-group-sm mb-3"},es=["value"],ns={class:"block block-rounded"},ls={class:"block-content p-0"},as={key:0,class:"table border-0 table-borderless table-striped table-vcenter fs-sm"},ds={class:"text-center"},rs={class:"fw-semibold",style:{width:"100px"}},ps={class:"fw-semibold"},ms={class:"fw-semibold"},cs={key:0,class:"text-center"},bs={key:1,class:"text-center py-2 text-danger"};function fs(o,s,g,gs,ys,vs){const A=d("archive-upload"),k=d("notes"),w=d("send"),x=d("rec-list"),_=d("EasyDataTable"),E=d("router-link");return n(),l(h,null,[t("div",T,[t("div",B,[t("div",P,[s[27]||(s[27]=t("div",{class:"modal-header bg-primary-light text-white"},[t("h1",{class:"modal-title fs-5",id:"printModalLabel"},"چاپ فاکتور"),t("div",{class:"block-options"},[t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})])],-1)),t("div",W,[s[25]||(s[25]=t("p",{class:"mb-2"},"برای تغییر تنظیمات پیشفرض به بخش تنظیمات چاپ مراجعه نمایید",-1)),t("div",j,[i(t("select",{"onUpdate:modelValue":s[0]||(s[0]=u=>o.printOptions.paper=u),class:"form-select"},s[18]||(s[18]=[t("option",{value:"A4-L"},"A4 افقی",-1),t("option",{value:"A4"},"A4 عمودی",-1),t("option",{value:"A5-L"},"A5 افقی",-1),t("option",{value:"A5"},"A5 عمودی",-1)]),512),[[L,o.printOptions.paper]]),s[19]||(s[19]=t("label",null,"سایز کاغذ و حالت چاپ",-1))]),t("div",H,[i(t("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=u=>o.printOptions.bidInfo=u),type:"checkbox"},null,512),[[m,o.printOptions.bidInfo]]),s[20]||(s[20]=t("label",{class:"form-check-label"},"اطلاعات کسب‌وکار",-1))]),t("div",R,[i(t("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=u=>o.printOptions.pays=u),type:"checkbox"},null,512),[[m,o.printOptions.pays]]),s[21]||(s[21]=t("label",{class:"form-check-label"},"نمایش پرداخت‌های فاکتور",-1))]),t("div",q,[i(t("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=u=>o.printOptions.note=u),type:"checkbox"},null,512),[[m,o.printOptions.note]]),s[22]||(s[22]=t("label",{class:"form-check-label"},"یاداشت پایین فاکتور",-1))]),t("div",J,[i(t("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=u=>o.printOptions.taxInfo=u),type:"checkbox"},null,512),[[m,o.printOptions.taxInfo]]),s[23]||(s[23]=t("label",{class:"form-check-label"},"مالیات به تفکیک اقلام",-1))]),t("div",K,[i(t("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=u=>o.printOptions.discountInfo=u),type:"checkbox"},null,512),[[m,o.printOptions.discountInfo]]),s[24]||(s[24]=t("label",{class:"form-check-label"},"تخفیف به تفکیک اقلام",-1))])]),t("div",Q,[t("button",{class:"btn btn-primary mx-2",onClick:s[6]||(s[6]=u=>o.printInvoice()),type:"button"},s[26]||(s[26]=[t("i",{class:"si si-printer me-1"},null,-1),t("span",{class:""},"چاپ",-1)]))])])])]),t("div",X,[t("div",Y,[t("h3",Z,[t("button",{onClick:s[7]||(s[7]=u=>o.$router.back()),type:"button",class:"float-start d-none d-sm-none d-md-block btn btn-sm btn-link text-warning"},s[28]||(s[28]=[t("i",{class:"fa fw-bold fa-arrow-right"},null,-1)])),s[29]||(s[29]=t("i",{class:"fas fa-file-invoice-dollar"},null,-1)),s[30]||(s[30]=r(" مشاهده فاکتور "))]),t("div",tt,[this.item.doc.id!=0?(n(),O(A,{key:0,docid:this.item.doc.id,doctype:"rfsell",cat:"rfsell"},null,8,["docid"])):y("",!0),t("button",st,[t("span",ot,e(this.notes.count),1),s[31]||(s[31]=t("i",{class:"fa-regular fa-note-sticky me-1"},null,-1)),s[32]||(s[32]=t("span",{class:"d-none d-sm-inline-block"},"یاداشت‌‌ها",-1))]),c(k,{stat:o.notes,code:this.$route.params.id,typeNote:"rfsell"},null,8,["stat","code"]),i(t("button",ut,s[33]||(s[33]=[t("i",{class:"fas fa-check-double me-2"},null,-1),t("span",{class:""},"تسویه شده",-1)]),512),[[v,parseInt(this.item.doc.amount)<=parseInt(this.totalSend)]]),i(t("button",{type:"button",class:"btn btn-sm btn-danger",onClick:s[8]||(s[8]=u=>this.recModal.show())},s[34]||(s[34]=[t("i",{class:"fas fa-money-bill-1-wave"},null,-1),t("span",{class:"d-none d-sm-inline-block"},"پرداخت وجه",-1)]),512),[[v,parseInt(this.item.doc.amount)>parseInt(this.totalSend)]]),t("div",it,[t("div",et,[t("div",nt,[s[35]||(s[35]=C('<div class="modal-header" data-v-8701f473><h1 class="modal-title fs-5" id="exampleModalLabel1" data-v-8701f473><i class="fas fa-money-bill-1 ms-2" data-v-8701f473></i> ثبت پرداخت </h1><div class="block-options" data-v-8701f473><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" data-v-8701f473></button></div></div>',1)),t("div",lt,[c(w,{ref:"submitPay",windowsState:this.PayWindowsState,person:this.person.id,"original-doc":this.item.doc.code,"total-amount":parseInt(this.item.doc.amount)-parseInt(this.totalSend)},null,8,["windowsState","person","original-doc","total-amount"])]),s[36]||(s[36]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"بازگشت")],-1))])])]),t("button",{type:"button",class:"btn btn-sm btn-info ms-2",onClick:s[9]||(s[9]=u=>this.recListModal.show())},s[37]||(s[37]=[t("i",{class:"fas fa-arrow-alt-circle-down"},null,-1),t("span",{class:"d-none d-sm-inline-block"},"پرداخت‌ها",-1)])),t("div",at,[t("div",dt,[t("div",rt,[s[38]||(s[38]=C('<div class="modal-header" data-v-8701f473><h1 class="modal-title fs-5" id="exampleModalLabel1" data-v-8701f473><i class="fas fa-arrow-alt-circle-up ms-2" data-v-8701f473></i> پرداخت‌ها </h1><div class="block-options" data-v-8701f473><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" data-v-8701f473></button></div></div>',1)),t("div",pt,[c(x,{ref:"recListRef",windowsState:this.recListWindowsState,items:this.item.relatedDocs},null,8,["windowsState","items"])]),s[39]||(s[39]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"بازگشت")],-1))])])]),s[40]||(s[40]=t("button",{type:"button",class:"btn btn-sm btn-primary mx-2","data-bs-toggle":"modal","data-bs-target":"#printModal"},[t("i",{class:"si si-printer me-1"}),t("span",{class:"d-none d-sm-inline-block"},"چاپ فاکتور")],-1))])]),t("div",mt,[t("div",ct,[t("div",bt,[t("div",ft,[t("div",gt,[t("div",yt,[s[41]||(s[41]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"شماره",-1)),i(t("input",{type:"text",readonly:"readonly","onUpdate:modelValue":s[10]||(s[10]=u=>o.item.doc.code=u),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,512),[[a,o.item.doc.code]])])]),t("div",vt,[t("div",Ct,[s[42]||(s[42]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"تاریخ",-1)),i(t("input",{type:"text",readonly:"readonly","onUpdate:modelValue":s[11]||(s[11]=u=>o.item.doc.date=u),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,512),[[a,o.item.doc.date]])])]),t("div",ht,[t("div",At,[s[43]||(s[43]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"شرح",-1)),i(t("input",{type:"text",readonly:"readonly","onUpdate:modelValue":s[12]||(s[12]=u=>o.item.doc.des=u),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,512),[[a,o.item.doc.des]])])])]),s[62]||(s[62]=t("b",{class:"ps-2"},"تامین کننده",-1)),t("div",kt,[t("div",wt,[t("div",xt,[s[44]||(s[44]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"نام",-1)),i(t("input",{type:"text",readonly:"readonly","onUpdate:modelValue":s[13]||(s[13]=u=>o.person.nikename=u),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,512),[[a,o.person.nikename]])])]),t("div",_t,[t("div",Et,[s[45]||(s[45]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"موبایل",-1)),i(t("input",{type:"text",readonly:"readonly","onUpdate:modelValue":s[14]||(s[14]=u=>o.person.mobile=u),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,512),[[a,o.person.mobile]])])]),t("div",Ft,[t("div",It,[s[46]||(s[46]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"تلفن",-1)),i(t("input",{type:"text",readonly:"readonly","onUpdate:modelValue":s[15]||(s[15]=u=>o.person.tel=u),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,512),[[a,o.person.tel]])])]),t("div",zt,[t("div",Gt,[s[47]||(s[47]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"کد پستی",-1)),i(t("input",{type:"text",readonly:"readonly","onUpdate:modelValue":s[16]||(s[16]=u=>o.person.postalcode=u),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,512),[[a,o.person.postalcode]])])]),t("div",St,[t("div",Dt,[s[48]||(s[48]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"آدرس",-1)),i(t("input",{type:"text",readonly:"readonly","onUpdate:modelValue":s[17]||(s[17]=u=>o.person.address=u),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,512),[[a,o.person.address]])])])]),s[63]||(s[63]=t("b",{class:"ps-2"},"اقلام",-1)),c(_,{"table-class-name":"customize-table",headers:o.mobileHeaders,items:o.commoditys,"show-index":"",alternating:"","theme-color":"#1d90ff","header-text-direction":"center","body-text-direction":"center",rowsPerPageMessage:"تعداد سطر",emptyMessage:"اطلاعاتی برای نمایش وجود ندارد",rowsOfPageSeparatorMessage:"از",loading:o.loading},{"item-sumTotal":b(({sumTotal:u})=>[r(e(o.$filters.formatNumber(u)),1)]),"item-count":b(({count:u,commodity:f})=>[r(e(u)+" "+e(f.unit),1)]),expand:b(({tax:u,discount:f,des:F,price:I})=>[t("div",Mt,[t("ul",$t,[t("li",Vt,[s[49]||(s[49]=r(" قیمت واحد ")),t("span",Lt,e(o.$filters.formatNumber(I)),1)]),t("li",Ot,[s[50]||(s[50]=r(" تخفیف ")),t("span",Ut,e(o.$filters.formatNumber(f)),1)]),t("li",Nt,[s[51]||(s[51]=r(" مالیات ")),t("span",Tt,e(o.$filters.formatNumber(u)),1)]),t("li",Bt," شرح: "+e(F),1)])])]),_:1},8,["headers","items","loading"]),t("div",Pt,[t("div",Wt,[t("div",jt,[s[52]||(s[52]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"جمع کل",-1)),t("input",{type:"text",readonly:"readonly",value:this.$filters.formatNumber(this.item.doc.amount),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,8,Ht)])]),t("div",Rt,[t("div",qt,[s[53]||(s[53]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"وضعیت",-1)),parseInt(this.item.doc.amount)<=parseInt(this.totalSend)?(n(),l("input",Jt)):(n(),l("input",Kt))])])]),t("div",Qt,[t("div",Xt,[t("div",Yt,[s[54]||(s[54]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"مالیات",-1)),t("input",{type:"text",readonly:"readonly",value:this.$filters.formatNumber(this.totalTax),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,8,Zt)])]),t("div",ts,[t("div",ss,[s[55]||(s[55]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"تخفیف",-1)),t("input",{type:"text",readonly:"readonly",value:this.$filters.formatNumber(this.discountAll),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,8,os)])]),t("div",us,[t("div",is,[s[56]||(s[56]=t("span",{class:"input-group-text",id:"inputGroup-sizing-sm"},"هزینه حمل و نقل",-1)),t("input",{type:"text",readonly:"readonly",value:this.$filters.formatNumber(this.transferCost),class:"form-control","aria-describedby":"inputGroup-sizing-sm"},null,8,es)])])]),t("div",ns,[s[61]||(s[61]=t("div",{class:"block-header block-header-default"},[t("h3",{class:"block-title"},"پرداخت‌ها"),t("div",{class:"block-options"})],-1)),t("div",ls,[o.item.relatedDocs.length!=0?(n(),l("table",as,[s[59]||(s[59]=t("thead",{class:"bg-primary text-light"},[t("tr",{class:"text-center"},[t("th",null,"مشاهده"),t("th",null,"شماره"),t("th",null,"تاریخ"),t("th",null,"مبلغ")])],-1)),t("tbody",null,[(n(!0),l(h,null,U(o.item.relatedDocs,u=>(n(),l("tr",ds,[t("td",null,[c(E,{to:"/acc/accounting/view/"+u.code},{default:b(()=>s[57]||(s[57]=[t("span",{class:"text-success fa fa-eye"},null,-1)])),_:2},1032,["to"])]),t("td",rs,e(u.code),1),t("td",ps,e(u.date),1),t("td",ms,e(o.$filters.formatNumber(u.amount)),1)]))),256)),o.item.relatedDocs.length==0?(n(),l("tr",cs,s[58]||(s[58]=[t("td",{colspan:"4"}," سند پرداختی تاکنون ثبت نشده است. ",-1)]))):y("",!0)])])):(n(),l("div",bs,s[60]||(s[60]=[t("span",null,"تاکنون سند پرداختی ثبت نشده است",-1)])))])])])])])])],64)}const _s=z(N,[["render",fs],["__scopeId","data-v-8701f473"]]);export{_s as default};
