import{_ as T,L as U,c as E,a as u}from"./main-9b36f05f.js";import{r as z,a as l,o as i,s as h,b as s,w as o,F as y,_ as A,c as b,A as F,C as H,d,t as w,e as R}from"./vendor-adef9cb4.js";const Y={name:"list",components:{Loading:U},data:()=>({loading:z(!0),contents:[],apiurl:"",selectedMoney:{name:"",label:""},showProgress:!1,progress:0,currentMessage:"",sponsorMessage:""}),methods:{async loadData(){this.apiurl=E();try{const[e,t]=await Promise.all([u.post("/api/business/list"),u.get("/api/general/sponsors")]);this.contents=e.data,this.contents.forEach(a=>{a.selectedMoney=a.arzmain}),t.data&&t.data.result&&(this.sponsorMessage=t.data.result)}catch(e){console.error("خطا در دریافت اطلاعات:",e),this.sponsorMessage=""}finally{this.loading=!1}},randomDelay(e=500,t=1500){return new Promise(a=>{const r=Math.floor(Math.random()*(t-e+1))+e;setTimeout(a,r)})},async showLoadingProgress(e){this.showProgress=!0,this.progress=0;const t=[{message:"در حال دریافت اطلاعات کسب و کار",progress:20},{message:"در حال بارگذاری داده‌های پایه",progress:40},{message:"تطبیق و ارزیابی داده‌ها",progress:60},{message:"بررسی مجوزها و دسترسی‌ها",progress:80},{message:`در حال انتقال به داشبورد کسب‌وکار "${e}"`,progress:95},{message:this.sponsorMessage||`در حال انتقال به داشبورد کسب‌وکار "${e}"`,progress:100,delay:5e3}];for(let a=0;a<t.length;a++){this.currentMessage=t[a].message,this.progress=t[a].progress;const r=t[a].delay||await this.randomDelay();await new Promise(_=>setTimeout(_,r))}this.showProgress=!1},async runBid(e,t){await this.showLoadingProgress(t),await localStorage.setItem("activeBid",e),this.contents.forEach(a=>{a.id==e&&(localStorage.setItem("activeMoney",a.selectedMoney.name),localStorage.setItem("activeMoneySymbol",a.selectedMoney.symbol),localStorage.setItem("activeMoneyShortName",a.selectedMoney.shortName),localStorage.setItem("activeMoneyLabel",a.selectedMoney.label))}),await u.post("/api/year/list",{},{headers:{activeBid:e}}).then(a=>{a.data.forEach(r=>{r.head=="1"&&localStorage.setItem("activeYear",r.id)}),window.location.href="/acc/dashboard"})}},beforeMount(){this.loadData()}},j=["innerHTML"];function q(e,t,a,r,_,M){const V=l("v-spacer"),g=l("v-btn"),x=l("v-tooltip"),P=l("v-toolbar"),$=l("v-skeleton-loader"),c=l("v-col"),S=l("v-avatar"),k=l("v-list-item"),B=l("v-select"),v=l("v-row"),p=l("v-card-text"),m=l("v-card"),L=l("v-icon"),I=l("v-card-title"),C=l("v-progress-linear"),D=l("v-dialog"),N=l("v-container");return i(),h(y,null,[s(P,{color:"toolbar",title:e.$t("title.user.businesses")},{default:o(()=>[s(V),s(x,{text:e.$t("title.user.business_create"),location:"bottom"},{activator:o(({props:n})=>[s(g,A(n,{icon:"mdi-store-plus-outline",color:"primary",to:"/profile/new-business"}),null,16)]),_:1},8,["text"])]),_:1},8,["title"]),s(N,{class:"pa-0 ma-0"},{default:o(()=>[s(m,{loading:e.loading?"red":null,disabled:e.loading},{default:o(()=>[s(p,null,{default:o(()=>[s(v,null,{default:o(()=>[e.loading?(i(),b(c,{key:0,cols:"12",sm:"12",md:"12",class:"pa-0 ma-0"},{default:o(()=>[s($,{class:"my-5 mx-5",elevation:1,type:"list-item-avatar"})]),_:1})):F("",!0),(i(!0),h(y,null,H(e.contents,n=>(i(),b(c,{cols:"12",sm:"12",md:"6",class:"px-1"},{default:o(()=>[s(m,{class:"mx-auto mb-3",border:"",flat:""},{default:o(()=>[s(k,{class:"px-6",height:"88"},{prepend:o(()=>[s(S,{color:"surface-light",size:"55",image:e.apiurl+"/front/avatar/file/get/"+n.id,alt:n.name},null,8,["image","alt"])]),title:o(()=>[d(w(n.name),1)]),subtitle:o(()=>[d(w(n.owner),1)]),append:o(()=>[s(g,{onClick:f=>M.runBid(n.id,n.name),class:"text-none",color:"primary",text:e.$t("pages.dashboard.login"),"append-icon":"mdi-arrow-left",slim:""},null,8,["onClick","text"])]),_:2},1024),s(p,{class:"text-medium-emphasis pa-1 px-3"},{default:o(()=>[s(v,null,{default:o(()=>[s(c,{cols:"12",sm:"12",md:"12",class:"mb-0"},{default:o(()=>[s(B,{density:"comfortable","prepend-inner-icon":"mdi-cash",modelValue:n.selectedMoney,"onUpdate:modelValue":f=>n.selectedMoney=f,label:e.$t("pages.dashboard.money"),variant:"solo-filled",items:n.moneys,"item-title":"label"},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1})]),_:1})]),_:1},8,["loading","disabled"]),s(D,{modelValue:e.showProgress,"onUpdate:modelValue":t[1]||(t[1]=n=>e.showProgress=n),persistent:"","max-width":"700px"},{default:o(()=>[s(m,{class:"pa-4",elevation:"8",rounded:"lg"},{default:o(()=>[s(I,{class:"text-h6 font-weight-bold text-center primary--text"},{default:o(()=>[s(L,{left:""},{default:o(()=>t[2]||(t[2]=[d("mdi-loading")])),_:1}),t[3]||(t[3]=d(" در حال آماده‌سازی... "))]),_:1}),s(p,{class:"pt-4"},{default:o(()=>[s(C,{modelValue:e.progress,"onUpdate:modelValue":t[0]||(t[0]=n=>e.progress=n),color:"primary",height:"12",rounded:"",striped:"",class:"progress-bar"},null,8,["modelValue"]),R("div",{class:"mt-6 text-center text-subtitle-1",innerHTML:e.currentMessage},null,8,j)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)}const K=T(Y,[["render",q],["__scopeId","data-v-2ab5c223"]]);export{K as default};
