import{_ as F,a as c,S as m}from"./main-9b36f05f.js";import{a,o as V,s as T,b as i,w as l,F as B,aa as A,d as C,t as j}from"./vendor-adef9cb4.js";const k={name:"new",data(){return{item:{title:"",body:"",bid:null},bidItems:[],attachedFile:null,loading:!0}},beforeMount(){this.loadData()},methods:{loadData(){c.post("/api/business/list").then(e=>{this.bidItems=e.data,this.loading=!1,e.data.length===0?m.fire({text:this.$t("pages.support.no_business_alert"),showCancelButton:!0,confirmButtonText:this.$t("pages.support.create_business"),cancelButtonText:this.$t("dialog.back")}).then(t=>{t.isConfirmed?this.$router.push("/profile/new-business"):this.$router.push("/profile/dashboard")}):this.item.bid=null}).catch(e=>{this.loading=!1,m.fire({text:this.$t("pages.support.load_error")+e.message,icon:"error",confirmButtonText:this.$t("dialog.confirm")})})},validateFile(e){if(!e||Array.isArray(e)&&e.length===0)return!0;const t=Array.isArray(e)?e[0]:e;return t instanceof File?["image/png","image/jpeg","image/jpg","application/pdf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-rar-compressed"].includes(t.type)?t.size>5*1024*1024?this.$t("validator.file_size_limit"):!0:this.$t("validator.invalid_file_type"):this.$t("validator.invalid_file_type")},async submit(){const{valid:e}=await this.$refs.form.validate();if(e){this.loading=!0;const t=new FormData;t.append("title",this.item.title),t.append("body",this.item.body),t.append("bid",this.item.bid?this.item.bid.id:"");const d=Array.isArray(this.attachedFile)&&this.attachedFile.length>0?this.attachedFile[0]:this.attachedFile;d instanceof File&&t.append("files[0]",d),c.post("/api/support/mod",t,{headers:{"Content-Type":"multipart/form-data"}}).then(p=>{this.loading=!1,p.data.error===0&&m.fire({text:this.$t("pages.support.saved"),icon:"success",confirmButtonText:this.$t("dialog.ok")}).then(()=>{this.$router.push("/profile/support-list")})}).catch(p=>{this.loading=!1,m.fire({text:this.$t("pages.support.submit_error")+p.message,icon:"error",confirmButtonText:this.$t("dialog.confirm")})})}}}};function D(e,t,d,p,o,u){const f=a("v-toolbar"),_=a("v-alert"),s=a("v-col"),r=a("v-row"),h=a("v-text-field"),b=a("v-select"),g=a("v-textarea"),v=a("v-file-input"),y=a("v-btn"),x=a("v-card"),w=a("v-form"),$=a("v-container");return V(),T(B,null,[i(f,{color:"toolbar",title:e.$t("pages.support.new")},null,8,["title"]),i($,{class:"pa-0 ma-0"},{default:l(()=>[i(r,null,{default:l(()=>[i(s,{class:""},{default:l(()=>[i(w,{"fast-fail":"",ref:"form",onSubmit:t[5]||(t[5]=A(()=>{},["prevent"]))},{default:l(()=>[i(x,{class:"pa-3",loading:o.loading?"red":null,disabled:o.loading,flat:""},{default:l(()=>[i(r,null,{default:l(()=>[i(s,{cols:"12",sm:"12",md:"12"},{default:l(()=>[i(_,{icon:"mdi-information-slab-box-outline",text:e.$t("pages.support.alert_top"),type:"info"},null,8,["text"])]),_:1})]),_:1}),i(r,null,{default:l(()=>[i(s,{cols:"12",sm:"12",md:"6"},{default:l(()=>[i(h,{label:e.$t("pages.support.title"),modelValue:o.item.title,"onUpdate:modelValue":t[0]||(t[0]=n=>o.item.title=n),type:"text","prepend-inner-icon":"mdi-format-title",rules:[()=>o.item.title.length>0||e.$t("validator.required")]},null,8,["label","modelValue","rules"])]),_:1}),i(s,{cols:"12",sm:"12",md:"6"},{default:l(()=>[i(b,{label:e.$t("pages.support.bid"),"prepend-inner-icon":"mdi-domain",items:o.bidItems,"item-title":"name","return-object":"",modelValue:o.item.bid,"onUpdate:modelValue":t[1]||(t[1]=n=>o.item.bid=n),clearable:""},null,8,["label","items","modelValue"])]),_:1})]),_:1}),i(r,null,{default:l(()=>[i(s,{cols:"12",sm:"12",md:"12"},{default:l(()=>[i(g,{label:e.$t("pages.support.body"),modelValue:o.item.body,"onUpdate:modelValue":t[2]||(t[2]=n=>o.item.body=n),type:"text","prepend-inner-icon":"mdi-text",rules:[()=>o.item.body.length>0||e.$t("validator.required")]},null,8,["label","modelValue","rules"])]),_:1})]),_:1}),i(r,null,{default:l(()=>[i(s,{cols:"12",sm:"12",md:"12"},{default:l(()=>[i(v,{modelValue:o.attachedFile,"onUpdate:modelValue":t[3]||(t[3]=n=>o.attachedFile=n),label:e.$t("dialog.attach_file"),"prepend-icon":"mdi-paperclip",accept:".png, .jpg, .jpeg, .pdf, .xls, .xlsx, .zip, .rar",rules:[u.validateFile],hint:e.$t("dialog.allowed_file_types_hint"),"persistent-hint":""},null,8,["modelValue","label","rules","hint"])]),_:1})]),_:1}),i(y,{onClick:t[4]||(t[4]=n=>u.submit()),type:"submit",color:"primary",class:"mt-3","prepend-icon":"mdi-content-save",loading:o.loading},{default:l(()=>[C(j(e.$t("dialog.save")),1)]),_:1},8,["loading"])]),_:1},8,["loading","disabled"])]),_:1},512)]),_:1})]),_:1})]),_:1})],64)}const S=F(k,[["render",D],["__scopeId","data-v-b184a13d"]]);export{S as default};
