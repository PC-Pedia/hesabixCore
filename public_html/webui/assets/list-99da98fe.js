import{a as M}from"./main-9b36f05f.js";import{r as v,O as ne,j as se,a as n,o as r,s as u,b as e,w as l,F as z,_ as w,e as F,d,t as i,A as c,v as H,C as re,c as ie}from"./vendor-adef9cb4.js";const ue={key:0,class:"text-center"},de={key:1,class:"text-center"},ce={key:2,class:"text-center"},me={key:3,class:"text-center"},_e={key:0},ve={key:4,class:"text-center"},pe={key:5,class:"text-center"},be={key:6,class:"text-center"},fe={key:7,class:"text-center"},ge={key:8,class:"text-center"},ke={key:9,class:"text-center"},J="hesabix_bank_table_columns",xe={__name:"list",setup(ye){const p=v(!1),h=v([]),$=v(""),x=v(!1),b=v({show:!1,code:null}),_=v({show:!1,title:"",message:"",color:"primary"}),E=o=>o?Number(o).toLocaleString("fa-IR"):"0",R=o=>o?o.replace(/(\d{4})(?=\d)/g,"$1-"):"",T=o=>o?o.replace(/(.{4})/g,"$1 ").trim():"",g=v([{title:"عملیات",key:"operation",align:"center",sortable:!1,width:100,visible:!0},{title:"کد",key:"code",align:"center",sortable:!0,width:100,visible:!0},{title:"بانک",key:"name",align:"center",sortable:!0,width:140,visible:!0},{title:"موجودی",key:"balance",align:"center",sortable:!0,width:140,visible:!0},{title:"صاحب حساب",key:"owner",align:"center",sortable:!0,width:120,visible:!0},{title:"شماره کارت",key:"cardNum",align:"center",sortable:!0,width:120,visible:!0},{title:"شبا",key:"shaba",align:"center",sortable:!0,width:160,visible:!0},{title:"شعبه",key:"shobe",align:"center",sortable:!0,width:120,visible:!0},{title:"تلفن اینترنت بانک",key:"mobileInternetBank",align:"center",sortable:!0,width:120,visible:!0},{title:"شماره کارتخوان",key:"posNum",align:"center",sortable:!0,width:100,visible:!0}]),j=ne(()=>g.value.filter(o=>o.visible)),m=o=>{var t;return(t=g.value.find(s=>s.key===o))==null?void 0:t.visible},G=()=>{const o=localStorage.getItem(J);if(o){const t=JSON.parse(o);g.value.forEach(s=>{s.visible=t.includes(s.key)})}},K=()=>{const o=g.value.filter(t=>t.visible).map(t=>t.key);localStorage.setItem(J,JSON.stringify(o))},k=(o,t="پیام",s="primary")=>{_.value={show:!0,title:t,message:o,color:s}},P=o=>{b.value={show:!0,code:o}},Y=async()=>{p.value=!0;try{const o=await M.post("/api/bank/list");h.value=o.data}catch(o){console.error("Error loading data:",o),k("خطا در بارگذاری داده‌ها: "+o.message,"خطا","error")}finally{p.value=!1}},q=async()=>{const o=b.value.code;if(b.value.show=!1,!!o)try{p.value=!0;const t=await M.post(`/api/bank/delete/${o}`);t.data.result===1?(h.value=h.value.filter(s=>s.code!==o),k("بانک با موفقیت حذف شد.","موفقیت","success")):t.data.result===2?k("بانک به دلیل داشتن تراکنش و اسناد حسابداری مرتبط قابل حذف نیست.","خطا","error"):t.data.result===3&&k("بانک به دلیل انتخاب به عنوان تسویه کیف پول قابل حذف نیست.","خطا","error")}catch(t){console.error("Error deleting item:",t),k("خطا در حذف آیتم: "+t.message,"خطا","error")}finally{p.value=!1}};return se(()=>{G(),Y()}),(o,t)=>{const s=n("v-btn"),C=n("v-tooltip"),V=n("v-spacer"),U=n("v-slide-group-item"),Q=n("v-slide-group"),O=n("v-toolbar"),y=n("v-icon"),W=n("v-text-field"),N=n("v-list-item-title"),S=n("v-list-item"),X=n("v-list"),Z=n("v-menu"),ee=n("router-link"),te=n("v-data-table"),le=n("v-checkbox"),oe=n("v-col"),ae=n("v-row"),B=n("v-card-text"),I=n("v-card"),D=n("v-dialog"),L=n("v-card-title"),A=n("v-card-actions");return r(),u(z,null,[e(O,{color:"toolbar",title:o.$t("drawer.banks_accounts")},{prepend:l(()=>[e(C,{text:o.$t("dialog.back"),location:"bottom"},{activator:l(({props:a})=>[e(s,w(a,{onClick:t[0]||(t[0]=f=>o.$router.back()),class:"d-none d-sm-flex",variant:"text",icon:"mdi-arrow-right"}),null,16)]),_:1},8,["text"])]),default:l(()=>[e(V),e(Q,{"show-arrows":""},{default:l(()=>[e(U,null,{default:l(()=>[e(C,{text:o.$t("dialog.add_new"),location:"bottom"},{activator:l(({props:a})=>[e(s,w(a,{icon:"mdi-plus",color:"primary",to:"/acc/banks/mod/"}),null,16)]),_:1},8,["text"])]),_:1}),e(U,null,{default:l(()=>[e(C,{text:o.$t("dialog.column_settings"),location:"bottom"},{activator:l(({props:a})=>[e(s,w(a,{icon:"mdi-table-cog",color:"primary",onClick:t[1]||(t[1]=f=>x.value=!0)}),null,16)]),_:1},8,["text"])]),_:1})]),_:1})]),_:1},8,["title"]),e(W,{modelValue:$.value,"onUpdate:modelValue":t[2]||(t[2]=a=>$.value=a),loading:p.value,color:"green",class:"mb-0 pt-0 rounded-0","hide-details":"auto",density:"compact",placeholder:o.$t("dialog.search_txt"),clearable:""},{"prepend-inner":l(()=>[e(C,{location:"bottom",text:o.$t("dialog.search")},{activator:l(({props:a})=>[e(y,w(a,{color:"danger",icon:"mdi-magnify"}),null,16)]),_:1},8,["text"])]),_:1},8,["modelValue","loading","placeholder"]),e(te,{headers:j.value,items:h.value,loading:p.value,search:$.value,class:"elevation-1 text-center"},{item:l(({item:a})=>[F("tr",null,[m("operation")?(r(),u("td",ue,[e(Z,null,{activator:l(({props:f})=>[e(s,w({variant:"text",size:"small",color:"error",icon:"mdi-menu"},f),null,16)]),default:l(()=>[e(X,null,{default:l(()=>[e(S,{to:"/acc/banks/card/view/"+a.code},{prepend:l(()=>[e(y,{color:"success",icon:"mdi-eye"})]),default:l(()=>[e(N,null,{default:l(()=>[d(i(o.$t("dialog.view")),1)]),_:1})]),_:2},1032,["to"]),e(S,{to:"/acc/banks/mod/"+a.code},{prepend:l(()=>[e(y,{icon:"mdi-pencil"})]),default:l(()=>[e(N,null,{default:l(()=>[d(i(o.$t("dialog.edit")),1)]),_:1})]),_:2},1032,["to"]),e(S,{onClick:f=>P(a.code)},{prepend:l(()=>[e(y,{color:"error",icon:"mdi-delete"})]),default:l(()=>[e(N,null,{default:l(()=>[d(i(o.$t("dialog.delete")),1)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)])):c("",!0),m("code")?(r(),u("td",de,i(E(a.code)),1)):c("",!0),m("name")?(r(),u("td",ce,[e(ee,{to:"/acc/banks/card/view/"+a.code},{default:l(()=>[d(i(a.name),1)]),_:2},1032,["to"])])):c("",!0),m("balance")?(r(),u("td",me,[F("span",{class:H(Number(a.balance)>=0?"text-success":"text-error")},[d(i(E(Math.abs(Number(a.balance))))+" ",1),Number(a.balance)<0?(r(),u("span",_e,"منفی")):c("",!0)],2)])):c("",!0),m("owner")?(r(),u("td",ve,i(a.owner),1)):c("",!0),m("cardNum")?(r(),u("td",pe,i(R(a.cardNum)),1)):c("",!0),m("shaba")?(r(),u("td",be,i(T(a.shaba)),1)):c("",!0),m("shobe")?(r(),u("td",fe,i(a.shobe),1)):c("",!0),m("mobileInternetBank")?(r(),u("td",ge,i(a.mobileInternetBank),1)):c("",!0),m("posNum")?(r(),u("td",ke,i(a.posNum),1)):c("",!0)])]),_:1},8,["headers","items","loading","search"]),e(D,{modelValue:x.value,"onUpdate:modelValue":t[4]||(t[4]=a=>x.value=a),"max-width":"500"},{default:l(()=>[e(I,null,{default:l(()=>[e(O,{color:"toolbar",title:o.$t("dialog.manage_columns")},{default:l(()=>[e(V),e(s,{icon:"",onClick:t[3]||(t[3]=a=>x.value=!1)},{default:l(()=>[e(y,null,{default:l(()=>t[9]||(t[9]=[d("mdi-close")])),_:1})]),_:1})]),_:1},8,["title"]),e(B,null,{default:l(()=>[e(ae,null,{default:l(()=>[(r(!0),u(z,null,re(g.value,a=>(r(),ie(oe,{key:a.key,cols:"12",sm:"6"},{default:l(()=>[e(le,{modelValue:a.visible,"onUpdate:modelValue":f=>a.visible=f,label:a.title,onChange:K,"hide-details":""},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(D,{modelValue:b.value.show,"onUpdate:modelValue":t[6]||(t[6]=a=>b.value.show=a),"max-width":"400"},{default:l(()=>[e(I,null,{default:l(()=>[e(L,{class:"text-h6"},{default:l(()=>t[10]||(t[10]=[d(" تأیید حذف ")])),_:1}),e(B,null,{default:l(()=>t[11]||(t[11]=[d(" آیا برای حذف حساب بانکی مطمئن هستید؟ ")])),_:1}),e(A,null,{default:l(()=>[e(V),e(s,{color:"primary",variant:"text",onClick:t[5]||(t[5]=a=>b.value.show=!1)},{default:l(()=>t[12]||(t[12]=[d("خیر")])),_:1}),e(s,{color:"error",variant:"text",onClick:q},{default:l(()=>t[13]||(t[13]=[d("بله")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(D,{modelValue:_.value.show,"onUpdate:modelValue":t[8]||(t[8]=a=>_.value.show=a),"max-width":"400"},{default:l(()=>[e(I,null,{default:l(()=>[e(L,{class:H(_.value.color+" text-h6")},{default:l(()=>[d(i(_.value.title),1)]),_:1},8,["class"]),e(B,{class:"pt-4"},{default:l(()=>[d(i(_.value.message),1)]),_:1}),e(A,null,{default:l(()=>[e(V),e(s,{color:"primary",variant:"text",onClick:t[7]||(t[7]=a=>_.value.show=!1)},{default:l(()=>t[14]||(t[14]=[d("قبول")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}};export{xe as default};
