import{_ as B,a as D}from"./main-9b36f05f.js";import{a as s,o as d,c as _,w as t,b as o,d as i,A as F,s as E,e as h,F as j,C as A,v as T,t as v,aa as U}from"./vendor-adef9cb4.js";const z={data(){return{packages:[],selectedPackage:null,loading:!1,initialLoading:!0,error:null,showErrorDialog:!1,canShowForm:!1,showFreePackageDialog:!1}},async mounted(){await this.checkFreeAccounting(),this.canShowForm&&this.fetchPackages()},methods:{async checkFreeAccounting(){var l,e;try{this.initialLoading=!0;const a=await D.post("/api/settings/get/can-free-accounting"),{value:c}=a.data;c===1||c==="1"?this.showFreePackageDialog=!0:c===0||c==="0"?this.canShowForm=!0:(console.warn("مقدار غیرمنتظره از سرور:",c),this.error="پاسخ نامعتبر از سرور",this.showErrorDialog=!0)}catch(a){console.error("خطا در بررسی بسته رایگان:",a),this.error="خطا در بررسی دسترسی: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.message)||a.message),this.showErrorDialog=!0}finally{this.initialLoading=!1}},redirectToDashboard(){this.showFreePackageDialog=!1,this.$router.push("/acc/dashboard")},async fetchPackages(){var l,e;try{this.loading=!0;const a=await D.post("/api/packagemanager/packages/list");this.packages=a.data.packages}catch(a){this.error="خطا در بارگذاری پکیج‌ها: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.message)||a.message),this.showErrorDialog=!0}finally{this.loading=!1}},selectPackage(l){this.selectedPackage=l},async submitOrder(){var l,e;if(!this.selectedPackage){this.error="لطفاً یک پکیج انتخاب کنید.",this.showErrorDialog=!0;return}try{this.loading=!0,this.error=null;const a=await D.post("/api/packagemanager/package/order/new",{month:this.selectedPackage}),{result:c,paymentUrl:r,message:u}=a.data;c?window.location.href=r:(this.error=u||"خطا در ثبت سفارش.",this.showErrorDialog=!0)}catch(a){this.error="خطا در ارسال درخواست پرداخت: "+(((e=(l=a.response)==null?void 0:l.data)==null?void 0:e.message)||a.message),this.showErrorDialog=!0}finally{this.loading=!1}},formatPrice(l){return Number(l).toLocaleString("fa-IR")}}},I={key:1},O={class:"text-h6"};function M(l,e,a,c,r,u){const P=s("v-icon"),m=s("v-btn"),V=s("v-toolbar-title"),k=s("v-spacer"),L=s("v-toolbar"),x=s("v-progress-circular"),g=s("v-row"),f=s("v-card-text"),p=s("v-card"),w=s("v-col"),y=s("v-card-title"),b=s("v-card-actions"),C=s("v-dialog"),S=s("v-container"),N=s("v-app");return d(),_(N,null,{default:t(()=>[o(L,{color:"toolbar"},{default:t(()=>[o(m,{icon:"",onClick:e[0]||(e[0]=n=>l.$router.go(-1))},{default:t(()=>[o(P,null,{default:t(()=>e[4]||(e[4]=[i("mdi-arrow-right")])),_:1})]),_:1}),o(V,null,{default:t(()=>e[5]||(e[5]=[i("سفارش بسته حسابداری نامحدود")])),_:1}),o(k)]),_:1}),o(S,{fluid:""},{default:t(()=>[r.initialLoading?(d(),_(g,{key:0,justify:"center",class:"mt-5"},{default:t(()=>[o(x,{indeterminate:"",color:"primary",size:50})]),_:1})):F("",!0),r.canShowForm&&!r.initialLoading?(d(),E("div",I,[o(g,{justify:"center"},{default:t(()=>[o(w,{cols:"12",md:"10"},{default:t(()=>[o(p,{flat:""},{default:t(()=>[o(f,null,{default:t(()=>e[6]||(e[6]=[h("p",{class:"text-body-1"}," با خرید بسته حسابداری نامحدود، می‌توانید بدون محدودیت اسناد حسابداری خود را ثبت کنید و از امکانات زیر بهره‌مند شوید: ",-1),h("p",{class:"text-body-2"}," این بسته‌ها برای کسب‌وکارهایی که نیاز به مدیریت حجم بالای تراکنش دارند، ایده‌آل است. همین حالا بسته مناسب خود را انتخاب کنید و مدیریت مالی خود را ساده‌تر کنید! ",-1)])),_:1})]),_:1})]),_:1})]),_:1}),o(g,{justify:"center"},{default:t(()=>[o(w,{cols:"12"},{default:t(()=>[r.loading?(d(),_(x,{key:0,indeterminate:"",color:"primary",class:"mb-4"})):(d(),_(g,{key:1},{default:t(()=>[(d(!0),E(j,null,A(r.packages,n=>(d(),_(w,{key:n.month,cols:"12",sm:"6",md:"3"},{default:t(()=>[o(p,{class:T({"selected-package":r.selectedPackage===n.month}),hover:"",onClick:R=>u.selectPackage(n.month)},{default:t(()=>[o(y,null,{default:t(()=>[i(v(n.month)+" ماهه",1)]),_:2},1024),o(f,null,{default:t(()=>[h("p",O,v(u.formatPrice(n.price))+" ریال",1),h("p",null,"ثبت نامحدود اسناد حسابداری به مدت "+v(n.month)+" ماه",1)]),_:2},1024),o(b,null,{default:t(()=>[o(m,{color:r.selectedPackage===n.month?"success":"grey",variant:"elevated",disabled:r.selectedPackage!==n.month,onClick:U(u.submitOrder,["stop"])},{default:t(()=>[o(P,{left:""},{default:t(()=>e[7]||(e[7]=[i("mdi-check-circle")])),_:1}),e[8]||(e[8]=i(" انتخاب و پرداخت "))]),_:2},1032,["color","disabled","onClick"])]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})])):F("",!0),o(C,{modelValue:r.showErrorDialog,"onUpdate:modelValue":e[2]||(e[2]=n=>r.showErrorDialog=n),"max-width":"400"},{default:t(()=>[o(p,null,{default:t(()=>[o(y,{class:"text-h6 red lighten-2"},{default:t(()=>e[9]||(e[9]=[i("خطا")])),_:1}),o(f,{class:"mt-2"},{default:t(()=>[i(v(r.error),1)]),_:1}),o(b,null,{default:t(()=>[o(k),o(m,{color:"primary",text:"",onClick:e[1]||(e[1]=n=>r.showErrorDialog=!1)},{default:t(()=>e[10]||(e[10]=[i("بستن")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(C,{modelValue:r.showFreePackageDialog,"onUpdate:modelValue":e[3]||(e[3]=n=>r.showFreePackageDialog=n),"max-width":"400"},{default:t(()=>[o(p,null,{default:t(()=>[o(y,{class:"text-h6 green lighten-2"},{default:t(()=>e[11]||(e[11]=[i("بسته رایگان فعال است")])),_:1}),o(f,{class:"mt-2"},{default:t(()=>e[12]||(e[12]=[i(" شما در حال حاضر از بسته حسابداری رایگان استفاده می‌کنید. به داشبورد منتقل خواهید شد. ")])),_:1}),o(b,null,{default:t(()=>[o(k),o(m,{color:"primary",text:"",onClick:u.redirectToDashboard},{default:t(()=>e[13]||(e[13]=[i("تأیید")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}const H=B(z,[["render",M],["__scopeId","data-v-ee94026e"]]);export{H as default};
