import{_ as L,l as z,L as Y,a as u,S as n}from"./main-9b36f05f.js";import{a as r,o as p,s as h,b as a,w as i,F as j,_ as m,e as s,d as l,t as d,A as v,u as x,ab as w,ao as R}from"./vendor-adef9cb4.js";import"./vue-persian-datetime-picker.common-0e5ba5b7.js";import{q as O,a as G}from"./quickAddCommodity-50dce749.js";import{q as H}from"./quickAdd-3f821e67.js";import{m as J}from"./mostdes-26bfade0.js";import"./vue3-treeselect.common-f8cf97d9.js";/* empty css                        */const K={name:"mod",components:{Money3:z,Loading:Y,quickView:O,quickAdd:H,quickAddCommodity:G,mostdes:J},data:()=>({tabs:0,searchBuyDoc:"",addsheet:!1,editsheet:!1,priceList:[],selectedPriceList:{id:0,label:"پیشفرض"},maliyatCheck:!0,maliyatPercent:0,bid:{maliyatafzode:0},desSubmit:{id:"",des:""},sumSelected:0,sumTax:0,sumTotal:0,itemsSelected:[],items:[],headers:[{text:"کالا",value:"commodity.name"},{text:"شرح",value:"des"},{text:"تعداد/مقدار",value:"count"},{text:"مبلغ واحد",value:"price"},{text:"تخفیف",value:"discount"},{text:"مالیات",value:"tax"},{text:"جمع بدون مالیات",value:"sumWithoutTax"},{text:"مبلغ کل",value:"sumTotal"},{text:"عملیات",value:"operation"}],selectedPersonWithDet:{},loading:!1,canSubmit:!0,updateID:null,sum:0,balance:0,currencyConfig:{masked:!1,prefix:"",suffix:"ریال",thousands:",",decimal:".",precision:0,disableNegative:!0,disabled:!1,min:0,max:null,allowBlank:!1,minimumNumberOfCharacters:1,shouldRound:!1,focusOnRight:!0},unitConfig:{masked:!1,prefix:"",suffix:"",thousands:",",decimal:".",precision:0,disableNegative:!0,disabled:!1,allowBlank:!1,shouldRound:!1,focusOnRight:!0},data:{date:"",des:"",person:"",transferCost:0,discountAll:0},year:{},persons:[],commodity:[],units:[],itemData:{id:0,commodity:{unit:"",unitData:{name:"",floatNumber:0}},count:0,price:0,sumTotal:0,sumWithoutTax:0,tax:0,des:"",discount:0},editItemData:{index:0,id:0,commodity:{unit:"",unitData:{name:"",floatNumber:0}},count:0,price:0,sumTotal:0,sumWithoutTax:0,tax:0,des:"",discount:0},sms:!1}),watch:{"editItemData.price":function(){this.editCalc()},"editItemData.discount":function(){this.editCalc()},"editItemData.count":function(){this.editCalc()},"editItemData.commodity":function(e,t){e!=""&&e!=null&&(this.unitConfig.precision=this.editItemData.commodity.unitData.floatNumber,this.editItemData.des=this.editItemData.commodity.des)},"desSubmit.id":function(){this.data.des=this.desSubmit.des},"itemData.price":function(){this.calc()},"itemData.discount":function(){this.calc()},maliyatCheck:function(e){e===!1?this.maliyatPercent=0:this.maliyatPercent=this.bid.maliyatafzode},maliyatPercent:function(e){this.maliyatPercent==""&&(this.maliyatPercent=0),this.items.forEach((t,c)=>{t.sumWithoutTax=t.price*t.count-t.discount,t.tax=(t.price*t.count-t.discount)*e/100,t.sumTotal=(parseFloat(t.price)*parseFloat(t.count)-parseFloat(t.discount))*(100+parseFloat(this.maliyatPercent))/100})},"itemData.count":function(){this.calc()},"itemData.commodity":function(e,t){e!=""&&e!=null&&(this.selectedPriceList.id==0?this.itemData.price=this.itemData.commodity.priceSell:Array.from(this.itemData.commodity.prices).forEach(g=>{g.list.id==this.selectedPriceList.id&&(this.itemData.price=g.priceSell)}),this.unitConfig.precision=this.itemData.commodity.unitData.floatNumber,this.itemData.des=this.itemData.commodity.des)},itemsSelected:{handler:function(e,t){this.sumSelected=0,this.itemsSelected.forEach(c=>{this.sumSelected+=parseFloat(c.sumTotal)})},deep:!0},selectedPriceList:{handler:function(e,t){this.selectedPriceList.id==0?this.itemData.price=this.itemData.commodity.priceSell:Array.from(this.itemData.commodity.prices).forEach(g=>{g.list.id==this.selectedPriceList.id&&(this.itemData.price=g.priceSell)})},deep:!0},items:{handler:function(e,t){this.calcInvoice()},deep:!0},"data.transferCost":{handler:function(e,t){this.calcInvoice()},deep:!1},"data.discountAll":{handler:function(e,t){this.calcInvoice()},deep:!1},"data.person":{handler:function(e,t){u.post("/api/person/info/"+this.data.person.code).then(c=>{this.selectedPersonWithDet=c.data})},deep:!0}},mounted(){},beforeMount(){this.loadData()},beforeRouteUpdate(e,t){this.loadData(e.params.id)},methods:{searchPerson(e,t){t(!0),u.post("/api/person/list/search",{search:e}).then(c=>{this.persons=c.data,t(!1)})},searchCommodity(e,t){t(!0),u.post("/api/commodity/list/search",{search:e}).then(c=>{this.commodity=c.data,t(!1)})},editItem(e){this.editItemData={...this.items[e-1]},this.editItemData.index=e},doEditeItem(){this.editItemData.count==0?n.fire({text:"تعداد صفر نامعتبر است.",icon:"error",confirmButtonText:"قبول"}):this.editItemData.price==0?n.fire({text:"قیمت صفر نامعتبر است.",icon:"error",confirmButtonText:"قبول"}):this.editItemData.commodity==""||this.editItemData.commodity==null?n.fire({text:"کالایی انتخاب نشده است.",icon:"error",confirmButtonText:"قبول"}):this.editItemData.sumTotal==0?n.fire({text:"جمع کل صفر شده است.",icon:"error",confirmButtonText:"قبول"}):(this.items[this.editItemData.index-1]=this.editItemData,n.fire({text:"آیتم فاکتور ویرایش شد.",icon:"success",confirmButtonText:"قبول"}))},calc(){this.itemData.sumWithoutTax=this.itemData.price*this.itemData.count-this.itemData.discount,this.itemData.commodity.withoutTax?(this.itemData.tax=0,this.itemData.sumTotal=parseFloat(this.itemData.price)*parseFloat(this.itemData.count)-parseFloat(this.itemData.discount)):(this.itemData.tax=(this.itemData.price*this.itemData.count-this.itemData.discount)*this.maliyatPercent/100,this.itemData.sumTotal=(parseFloat(this.itemData.price)*parseFloat(this.itemData.count)-parseFloat(this.itemData.discount))*(100+parseFloat(this.maliyatPercent))/100)},editCalc(){this.editItemData.sumWithoutTax=this.editItemData.price*this.editItemData.count-this.editItemData.discount,this.editItemData.commodity.withoutTax?(this.editItemData.tax=0,this.editItemData.sumTotal=parseFloat(this.editItemData.price)*parseFloat(this.editItemData.count)-parseFloat(this.editItemData.discount)):(this.editItemData.tax=(this.editItemData.price*this.editItemData.count-this.editItemData.discount)*this.maliyatPercent/100,this.editItemData.sumTotal=(parseFloat(this.editItemData.price)*parseFloat(this.editItemData.count)-parseFloat(this.editItemData.discount))*(100+parseFloat(this.maliyatPercent))/100)},calcInvoice(){this.sumTotal=0,this.sumTax=0,this.items.forEach(e=>{this.sumTotal+=parseFloat(e.sumTotal),e.commodity.withoutTax==!0?e.tax=0:this.sumTax+=parseFloat(e.tax)}),this.sumTotal+=this.data.transferCost,this.sumTotal-=this.data.discountAll},addItem(){this.itemData.count==0?n.fire({text:"تعداد صفر نامعتبر است.",icon:"error",confirmButtonText:"قبول"}):this.itemData.price==0?n.fire({text:"قیمت صفر نامعتبر است.",icon:"error",confirmButtonText:"قبول"}):this.itemData.commodity==""||this.itemData.commodity==null?n.fire({text:"کالایی انتخاب نشده است.",icon:"error",confirmButtonText:"قبول"}):this.itemData.sumTotal==0?n.fire({text:"جمع کل صفر شده است.",icon:"error",confirmButtonText:"قبول"}):(this.items.push(this.itemData),this.itemData={id:0,commodity:this.commodity[0],count:0,price:0,sumTotal:0,sumWithoutTax:0,tax:0,des:"",discount:0},n.fire({text:"آیتم به فاکتور افزوده شد.",icon:"success",confirmButtonText:"قبول"}))},deleteItem(e){n.fire({text:"آیا برای حذف این مورد مطمئن هستید؟",showCancelButton:!0,confirmButtonText:"بله",cancelButtonText:"خیر"}).then(t=>{t.isConfirmed&&this.items.splice(e-1,1)})},loadData(){this.loading=!0,u.post("/api/commodity/pricelist/list").then(e=>{this.priceList=e.data,this.priceList.push({id:0,label:"پیشفرض"})}),u.post("/api/year/get").then(e=>{this.year=e.data,this.data.date=e.data.now}),u.post("/api/business/get/info/"+localStorage.getItem("activeBid")).then(e=>{this.bid=e.data,this.bid.maliyatafzode==0&&(this.maliyatCheck=!1),this.maliyatPercent=this.bid.maliyatafzode,this.loading=!1}),u.post("/api/person/list/search").then(e=>{this.persons=e.data}),u.post("/api/commodity/list/search").then(e=>{this.commodity=e.data,e.data.length!=0?this.itemData.commodity=e.data[0]:n.fire({text:"برای ثبت فاکتور ابتدا یک کالای جدید تعریف کنید.",icon:"warning",confirmButtonText:"تعریف کالای جدید"})}),u.post("/api/commodity/units").then(e=>{this.units=e.data}),u.post("/api/sms/load/settings").then(e=>{this.sms=e.data.sendAfterPresell}),this.$route.params.id!=""&&u.post("/api/presell/get/info/"+this.$route.params.id).then(e=>{this.data.date=e.data.date,this.data.des=e.data.des,this.data.person=e.data.person,this.data.transferCost=e.data.transferCost,this.data.discountAll=e.data.discountAll,this.loading=!1,e.data.rows.forEach((t,c)=>{t.commodity!=null&&this.items.push({commodity:t.commodity,count:t.commodity_count,price:parseInt((parseInt(t.bs)-parseInt(t.tax)+parseInt(t.discount))/parseInt(t.commodity_count)),bs:t.bs,bd:t.bd,type:"commodity",id:t.commodity.id,des:t.des,discount:t.discount,tax:t.tax,sumWithoutTax:t.bs-t.tax,sumTotal:t.bs,table:53})})})},save(){this.canSubmit=!1,this.items.length==0?n.fire({text:"فاکتور فاقد کالا می باشد.",icon:"warning",confirmButtonText:"قبول"}):this.data.person==null||this.data.person==""?n.fire({text:"طرف حساب انتخاب نشده است.",icon:"warning",confirmButtonText:"قبول"}):(this.loading=!0,u.post("/api/presell/mod",{type:"sell",date:this.data.date,des:this.data.des,person:this.data.person,rows:this.items,discountAll:this.data.discountAll,transferCost:this.data.transferCost,update:this.$route.params.id,sms:this.sms}).then(e=>{this.loading=!1,e.data.code==0?n.fire({text:"فاکتور ثبت شد.",icon:"success",confirmButtonText:"قبول"}).then(()=>{this.$router.push("/acc/presell/list")}):e.data.result==1?n.fire({text:"پیش فاکتور ثبت و پیامک اطلاع رسانی به مشتری ارسال شد.",icon:"success",confirmButtonText:"قبول"}).then(()=>{this.$router.push("/acc/presell/list")}):e.data.result==2?n.fire({text:"پیش فاکتور ثبت شد ولی به دلیل کمبود اعتبار پیامک اطلاع رسانی به مشتری ارسال نشد..",icon:"success",confirmButtonText:"قبول"}).then(()=>{this.$router.push("/acc/presell/list")}):n.fire({text:e.data.message,icon:"error",confirmButtonText:"قبول"})}).catch(e=>{this.loading=!1,n.fire({text:"اتصال با سرویس دهنده برقرار نشد. لطفا اتصال اینترنت خود را بررسی نمایید.",icon:"error",confirmButtonText:"قبول"})})),this.canSubmit=!0}}},Q={class:"row"},X={class:"col-sm-12 col-md-6 mb-1"},Z={class:"block block-rounded border"},tt={class:"block-content pt-1 px-1"},et={class:"col-sm-12 col-md-6 mb-1"},st={class:"block block-rounded border"},ot={class:"block-header block-header-default py-1"},at={class:"block-options"},it={class:"block-content pt-1 px-1"},lt={class:"row mb-1"},dt={class:"col-12"},nt={class:"col-12"},rt={class:"row"},mt={class:"col-6"},ct={class:"col-6"},ut={key:0,class:"text-danger"},ft={key:1,class:"text-success"},pt={key:0,class:"text-info ms-2"},ht={key:0,class:"text-danger"},bt={key:1,class:"text-success"},vt={class:"col-sm-12 col-md-12 mb-1"},yt={class:"block block-rounded border"},Dt={class:"block-header block-header-default py-1"},gt={class:"block-options"},kt={class:"block-content p-0"},It={class:"row"},_t={class:"col-12"},xt={class:"container"},Vt={class:"row"},Tt={class:"col-sm-12 col-md-6 mb-0"},Ct={class:"block block-rounded border"},wt={class:"block-header block-header-default py-1"},Pt={class:"block-options"},$t={class:"block-content pt-1 px-1"},St={class:"row mb-1"},Bt={class:"col-12"},Mt={class:"col-12"},Nt={key:0},Ut={style:{direction:"ltr"}},Wt={class:"col-sm-12 col-md-6 mb-2"},Ft={class:"block block-rounded border"},At={class:"block-content p-0"},qt={class:"col-sm-12 col-md-6 mb-2"},Et={class:"form-floating mb-3"},Lt={key:0,for:"floatingInput"},zt={class:"col-sm-12 col-md-6 mb-2"},Yt={class:"input-group mb-3"},jt={class:"form-floating mb-3"},Rt={class:"col-sm-12 col-md-6 mb-2"},Ot={class:"form-floating mb-3"},Gt={class:"col-sm-12 col-md-6 mb-2"},Ht={class:"form-floating mb-3"},Jt={class:"row pa-2"},Kt={class:"col-sm-12 col-md-6 mb-0"},Qt={class:"block block-rounded border"},Xt={class:"block-header block-header-default py-1"},Zt={class:"block-options"},te={class:"block-content pt-1 px-1"},ee={class:"row mb-1"},se={class:"col-12"},oe={class:"col-12"},ae={key:0},ie={style:{direction:"ltr"}},le={class:"col-sm-12 col-md-6 mb-2"},de={class:"block block-rounded border"},ne={class:"block-content p-0"},re={class:"col-sm-12 col-md-6 mb-2"},me={class:"form-floating mb-3"},ce={key:0,for:"floatingInput"},ue={class:"col-sm-12 col-md-6 mb-2"},fe={class:"input-group mb-3"},pe={class:"form-floating mb-3"},he={class:"col-sm-12 col-md-6 mb-2"},be={class:"form-floating mb-3"},ve={class:"col-sm-12 col-md-6 mb-2"},ye={class:"form-floating mb-3"},De=["onClick"],ge=["onClick"],ke={class:"row mt-2"},Ie={class:"col-sm-12 col-md-4"},_e={class:"input-group input-group-sm mb-2"},xe={class:"input-group-text",id:"inputGroup-sizing-sm"},Ve={class:"col-sm-12 col-md-4"},Te={class:"input-group input-group-sm mb-2"},Ce={class:"col-sm-12 col-md-4"},we={class:"input-group input-group-sm mb-2"},Pe={class:"container-fluid p-0 mx-0 mt-2"},$e={class:"block block-rounded block-link-shadow border-start border-success border-3",href:"javascript:void(0)"},Se={class:"block-content block-content-full block-content-sm bg-body-light"},Be={class:"row"},Me={class:"col-sm-12 col-md-3"},Ne={class:"text-primary"},Ue={class:"col-sm-12 col-md-3"},We={class:"text-primary"},Fe={class:"col-sm-12 col-md-3"},Ae={class:"text-primary"},qe={class:"col-sm-12 col-md-3"},Ee={class:"text-primary"};function Le(e,t,c,g,ze,y){const D=r("v-btn"),k=r("v-tooltip"),V=r("v-spacer"),U=r("v-switch"),I=r("v-icon"),T=r("v-toolbar"),W=r("date-picker"),F=r("quickView"),A=r("quickAdd"),C=r("v-cob"),q=r("mostdes"),P=r("v-card-text"),_=r("v-card"),$=r("quickAddCommodity"),f=r("money3"),S=r("v-col"),B=r("v-row"),M=r("v-bottom-sheet"),E=r("EasyDataTable");return p(),h(j,null,[a(T,{color:"toolbar",title:e.$t("dialog.presell_invoice")},{prepend:i(()=>[a(k,{text:e.$t("dialog.back"),location:"bottom"},{activator:i(({props:o})=>[a(D,m(o,{onClick:t[0]||(t[0]=b=>e.$router.back()),class:"d-none d-sm-flex",variant:"text",icon:"mdi-arrow-right"}),null,16)]),_:1},8,["text"])]),default:i(()=>[a(V),a(U,{disabled:this.selectedPersonWithDet.mobile==""||this.selectedPersonWithDet.mobile==null,modelValue:e.sms,"onUpdate:modelValue":t[1]||(t[1]=o=>e.sms=o),label:e.$t("dialog.sms"),color:"primary","hide-details":"true"},null,8,["disabled","modelValue","label"]),a(D,{disabled:this.canSubmit!=!0,onClick:t[2]||(t[2]=o=>y.save()),loading:e.loading,icon:"",color:"green"},{default:i(()=>[a(k,{activator:"parent",text:e.$t("dialog.save"),location:"bottom"},null,8,["text"]),a(I,{icon:"mdi-content-save"})]),_:1},8,["disabled","loading"])]),_:1},8,["title"]),a(B,{class:"pa-1"},{default:i(()=>[a(S,null,{default:i(()=>[a(_,{class:"mb-2"},{default:i(()=>[a(P,null,{default:i(()=>[s("div",Q,[s("div",X,[s("div",Z,[t[29]||(t[29]=s("div",{class:"block-header block-header-default py-1"},[s("h3",{class:"block-title text-primary"},[s("i",{class:"fa fa-calendar"}),l(" تاریخ ")]),s("div",{class:"block-options"})],-1)),s("div",tt,[s("p",null,[a(W,{class:"",modelValue:e.data.date,"onUpdate:modelValue":t[3]||(t[3]=o=>e.data.date=o),format:"jYYYY/jMM/jDD","display-format":"jYYYY/jMM/jDD",min:e.year.start,max:e.year.end},null,8,["modelValue","min","max"])])])])]),s("div",et,[s("div",st,[s("div",ot,[t[30]||(t[30]=s("h3",{class:"block-title text-primary"},[s("i",{class:"fa fa-person"}),l(" طرف حساب ")],-1)),s("div",at,[a(F,{code:this.data.person.code},null,8,["code"]),a(A,{code:this.data.person.code},null,8,["code"])])]),s("div",it,[a(C,{class:"mb-1 mx-0",filterable:!1,dir:"rtl",onSearch:y.searchPerson,options:e.persons,label:"nikename",modelValue:e.data.person,"onUpdate:modelValue":t[4]||(t[4]=o=>e.data.person=o)},{"no-options":i(({search:o,searching:b,loading:N})=>t[31]||(t[31]=[l(" نتیجه‌ای یافت نشد! ")])),option:i(o=>[s("div",lt,[s("div",dt,[t[32]||(t[32]=s("i",{class:"fa fa-user me-2"},null,-1)),l(" "+d(o.nikename),1)]),s("div",nt,[s("div",rt,[s("div",mt,[t[33]||(t[33]=s("i",{class:"fa fa-phone me-2"},null,-1)),l(" "+d(o.mobile),1)]),s("div",ct,[t[34]||(t[34]=s("i",{class:"fa fa-bars"},null,-1)),l(" تراز: "+d(e.$filters.formatNumber(Math.abs(parseInt(o.bs)-parseInt(o.bd))))+" ",1),parseInt(o.bs)-parseInt(o.bd)<0?(p(),h("span",ut," بدهکار ")):v("",!0),parseInt(o.bs)-parseInt(o.bd)>0?(p(),h("span",ft," بستانکار ")):v("",!0)])])])])]),_:1},8,["onSearch","options","modelValue"]),e.selectedPersonWithDet.bs!=null?(p(),h("span",pt,[l(" تراز: "+d(e.$filters.formatNumber(Math.abs(parseInt(this.selectedPersonWithDet.bs)-parseInt(this.selectedPersonWithDet.bd))))+" ",1),parseInt(this.selectedPersonWithDet.bs)-parseInt(this.selectedPersonWithDet.bd)<0?(p(),h("span",ht," بدهکار ")):v("",!0),parseInt(this.selectedPersonWithDet.bs)-parseInt(this.selectedPersonWithDet.bd)>0?(p(),h("span",bt," بستانکار ")):v("",!0)])):v("",!0)])])]),s("div",vt,[s("div",yt,[s("div",Dt,[t[35]||(t[35]=s("h3",{class:"block-title text-primary"},[s("i",{class:"fa-regular fa-note-sticky"}),l(" شرح ")],-1)),s("div",gt,[a(q,{submitData:e.desSubmit,type:"sell"},null,8,["submitData"])])]),s("div",kt,[x(s("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>e.data.des=o),class:"form-control",type:"text"},null,512),[[w,e.data.des]])])])])])]),_:1})]),_:1}),a(_,null,{default:i(()=>[a(P,null,{default:i(()=>[s("div",It,[s("div",_t,[a(M,{fullscreen:"",inset:"",class:"float-start",modelValue:e.addsheet,"onUpdate:modelValue":t[14]||(t[14]=o=>e.addsheet=o)},{activator:i(({props:o})=>[a(D,m(o,{color:"primary",class:""}),{default:i(()=>[a(I,null,{default:i(()=>t[36]||(t[36]=[l("mdi-plus")])),_:1}),l(" "+d(e.$t("dialog.add_row")),1)]),_:2},1040)]),default:i(()=>[a(_,{class:"bg-white",loading:e.loading},{default:i(()=>[a(T,{color:"toolbar",title:e.$t("drawer.commodity")},{prepend:i(()=>[a(k,{text:e.$t("dialog.back"),location:"bottom"},{activator:i(({props:o})=>[a(D,{icon:"mdi-close",onClick:t[6]||(t[6]=b=>e.addsheet=!e.addsheet)})]),_:1},8,["text"])]),default:i(()=>[a(V),a(D,{loading:e.loading,onClick:t[7]||(t[7]=o=>y.addItem()),icon:"",color:"green"},{default:i(()=>[a(k,{activator:"parent",text:e.$t("dialog.save"),location:"bottom"},null,8,["text"]),a(I,{icon:"mdi-content-save"})]),_:1},8,["loading"])]),_:1},8,["title"]),a(B,{class:"pa-2 my-auto"},{default:i(()=>[a(S,{cols:"12",sm:"12",md:"12"},{default:i(()=>[s("div",xt,[s("div",Vt,[s("div",Tt,[s("div",Ct,[s("div",wt,[t[37]||(t[37]=s("h3",{class:"block-title text-primary"},[s("i",{class:"fa fa-box pe-2"}),l(" کالا و خدمات ")],-1)),s("div",Pt,[a($)])]),s("div",$t,[a(C,{dir:"rtl",onSearch:y.searchCommodity,options:e.commodity,label:"name",modelValue:e.itemData.commodity,"onUpdate:modelValue":t[8]||(t[8]=o=>e.itemData.commodity=o),class:""},{"no-options":i(({search:o,searching:b,loading:N})=>t[38]||(t[38]=[l(" نتیجه‌ای یافت نشد! ")])),option:i(o=>[s("div",St,[s("div",Bt,[t[39]||(t[39]=s("i",{class:"fa fa-box me-1"},null,-1)),l(" "+d(o.name),1)]),s("div",Mt,[o.khadamat==!1?(p(),h("small",Nt,[t[40]||(t[40]=s("i",{class:"fa fa-store me-1"},null,-1)),t[41]||(t[41]=s("small",{class:"text-danger"}," موجودی: ",-1)),s("label",Ut,d(o.count),1),l(" "+d(o.unit),1)])):v("",!0)])])]),_:1},8,["onSearch","options","modelValue"])])])]),s("div",Wt,[s("div",Ft,[t[42]||(t[42]=s("div",{class:"block-header block-header-default py-1"},[s("h3",{class:"block-title text-primary"},[s("i",{class:"fa-regular fa-note-sticky"}),l(" شرح ")]),s("div",{class:"block-options"})],-1)),s("div",At,[x(s("input",{"onUpdate:modelValue":t[9]||(t[9]=o=>this.itemData.des=o),class:"form-control",type:"text"},null,512),[[w,this.itemData.des]])])])]),s("div",qt,[s("div",Et,[a(f,m(e.unitConfig,{class:"form-control",modelValue:this.itemData.count,"onUpdate:modelValue":t[10]||(t[10]=o=>this.itemData.count=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),e.itemData.commodity?(p(),h("label",Lt,d(e.itemData.commodity.unitData.name),1)):v("",!0)])]),s("div",zt,[s("div",Yt,[s("div",jt,[a(f,m(e.currencyConfig,{min:"0",class:"form-control",modelValue:this.itemData.price,"onUpdate:modelValue":t[11]||(t[11]=o=>this.itemData.price=o)}),null,16,["modelValue"]),t[43]||(t[43]=s("label",{for:"floatingInput"},"قیمت واحد",-1))])])]),s("div",Rt,[s("div",Ot,[a(f,m(e.currencyConfig,{class:"form-control",modelValue:this.itemData.discount,"onUpdate:modelValue":t[12]||(t[12]=o=>this.itemData.discount=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),t[44]||(t[44]=s("label",{for:"floatingInput"},"تخفیف",-1))])]),s("div",Gt,[s("div",Ht,[a(f,m({readonly:"readonly"},e.currencyConfig,{class:"form-control",modelValue:this.itemData.sumWithoutTax,"onUpdate:modelValue":t[13]||(t[13]=o=>this.itemData.sumWithoutTax=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),t[45]||(t[45]=s("label",{for:"floatingInput"},"قیمت کل",-1))])])])])]),_:1})]),_:1})]),_:1},8,["loading"])]),_:1},8,["modelValue"]),a(M,{fullscreen:"",inset:"",class:"float-start",modelValue:e.editsheet,"onUpdate:modelValue":t[23]||(t[23]=o=>e.editsheet=o)},{default:i(()=>[a(_,{class:"bg-white",loading:e.loading},{default:i(()=>[a(T,{color:"toolbar",title:e.$t("drawer.commodity")},{prepend:i(()=>[a(k,{text:e.$t("dialog.back"),location:"bottom"},{activator:i(({props:o})=>[a(D,{icon:"mdi-close",onClick:t[15]||(t[15]=b=>e.editsheet=!e.editsheet)})]),_:1},8,["text"])]),default:i(()=>[a(V),a(D,{loading:e.loading,onClick:t[16]||(t[16]=o=>y.doEditeItem()),icon:"",color:"green"},{default:i(()=>[a(k,{activator:"parent",text:e.$t("dialog.save"),location:"bottom"},null,8,["text"]),a(I,{icon:"mdi-content-save"})]),_:1},8,["loading"])]),_:1},8,["title"]),s("div",Jt,[s("div",Kt,[s("div",Qt,[s("div",Xt,[t[46]||(t[46]=s("h3",{class:"block-title text-primary"},[s("i",{class:"fa fa-box pe-2"}),l(" کالا و خدمات ")],-1)),s("div",Zt,[a($)])]),s("div",te,[a(C,{dir:"rtl",onSearch:y.searchCommodity,options:e.commodity,label:"name",modelValue:e.editItemData.commodity,"onUpdate:modelValue":t[17]||(t[17]=o=>e.editItemData.commodity=o),class:""},{"no-options":i(({search:o,searching:b,loading:N})=>t[47]||(t[47]=[l(" نتیجه‌ای یافت نشد! ")])),option:i(o=>[s("div",ee,[s("div",se,[t[48]||(t[48]=s("i",{class:"fa fa-box me-1"},null,-1)),l(" "+d(o.name),1)]),s("div",oe,[o.khadamat==!1?(p(),h("small",ae,[t[49]||(t[49]=s("i",{class:"fa fa-store me-1"},null,-1)),t[50]||(t[50]=s("small",{class:"text-danger"}," موجودی: ",-1)),s("label",ie,d(o.count),1),l(" "+d(o.unit),1)])):v("",!0)])])]),_:1},8,["onSearch","options","modelValue"])])])]),s("div",le,[s("div",de,[t[51]||(t[51]=s("div",{class:"block-header block-header-default py-1"},[s("h3",{class:"block-title text-primary"},[s("i",{class:"fa-regular fa-note-sticky"}),l(" شرح ")]),s("div",{class:"block-options"})],-1)),s("div",ne,[x(s("input",{"onUpdate:modelValue":t[18]||(t[18]=o=>this.editItemData.des=o),class:"form-control",type:"text"},null,512),[[w,this.editItemData.des]])])])]),s("div",re,[s("div",me,[a(f,m(e.unitConfig,{class:"form-control",modelValue:this.editItemData.count,"onUpdate:modelValue":t[19]||(t[19]=o=>this.editItemData.count=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),e.editItemData.commodity?(p(),h("label",ce,d(e.editItemData.commodity.unitData.name),1)):v("",!0)])]),s("div",ue,[s("div",fe,[s("div",pe,[a(f,m(e.currencyConfig,{min:"0",class:"form-control",modelValue:this.editItemData.price,"onUpdate:modelValue":t[20]||(t[20]=o=>this.editItemData.price=o)}),null,16,["modelValue"]),t[52]||(t[52]=s("label",{for:"floatingInput"},"قیمت واحد",-1))])])]),s("div",he,[s("div",be,[a(f,m(e.currencyConfig,{class:"form-control",modelValue:this.editItemData.discount,"onUpdate:modelValue":t[21]||(t[21]=o=>this.editItemData.discount=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),t[53]||(t[53]=s("label",{for:"floatingInput"},"تخفیف",-1))])]),s("div",ve,[s("div",ye,[a(f,m({readonly:"readonly"},e.currencyConfig,{class:"form-control",modelValue:this.editItemData.sumWithoutTax,"onUpdate:modelValue":t[22]||(t[22]=o=>this.editItemData.sumWithoutTax=o),modelModifiers:{number:!0}}),null,16,["modelValue"]),t[54]||(t[54]=s("label",{for:"floatingInput"},"قیمت کل",-1))])])])]),_:1},8,["loading"])]),_:1},8,["modelValue"]),a(E,{"table-class-name":"customize-table",class:"mt-3","items-selected":e.itemsSelected,"onUpdate:itemsSelected":t[24]||(t[24]=o=>e.itemsSelected=o),"show-index":"",alternating:"",headers:e.headers,items:e.items,"theme-color":"#1d90ff","header-text-direction":"center","body-text-direction":"center",rowsPerPageMessage:"تعداد سطر",emptyMessage:"هیچ آیتمی به این فاکتور افزوده نشده است.",rowsOfPageSeparatorMessage:"از"},{"item-operation":i(({index:o})=>[s("button",{title:"حذف",class:"btn btn-sm text-danger px-1",onClick:b=>y.deleteItem(o)},t[55]||(t[55]=[s("i",{class:"fa fa-trash"},null,-1)]),8,De),s("button",{title:"ویرایش",class:"btn btn-sm text-info px-1",onClick:b=>{y.editItem(o),e.editsheet=!0}},t[56]||(t[56]=[s("i",{class:"fa fa-edit"},null,-1)]),8,ge)]),"item-sumTotal":i(({sumTotal:o})=>[l(d(e.$filters.formatNumber(o)),1)]),"item-sumWithoutTax":i(({sumWithoutTax:o})=>[l(d(e.$filters.formatNumber(o)),1)]),"item-price":i(({price:o})=>[l(d(e.$filters.formatNumber(o)),1)]),"item-commodity.name":i(({commodity:o})=>[l(d(o.code)+" - "+d(o.name),1)]),"item-tax":i(({tax:o})=>[l(d(e.$filters.formatNumber(o)),1)]),"item-discount":i(({discount:o})=>[l(d(e.$filters.formatNumber(o)),1)]),"item-count":i(({count:o,commodity:b})=>[l(d(o)+" "+d(b.unit),1)]),_:1},8,["items-selected","headers","items"]),s("div",ke,[s("div",Ie,[s("div",_e,[s("span",xe,[x(s("input",{"onUpdate:modelValue":t[25]||(t[25]=o=>e.maliyatCheck=o),class:"form-check-input mt-0 me-2",type:"checkbox","aria-label":"Checkbox for following text input"},null,512),[[R,e.maliyatCheck]]),t[57]||(t[57]=l(" مالیات % "))]),a(f,m({disabled:!e.maliyatCheck},e.unitConfig,{"aria-label":"مالیات بر ارزش افزوده",class:"form-control",modelValue:e.maliyatPercent,"onUpdate:modelValue":t[26]||(t[26]=o=>e.maliyatPercent=o),modelModifiers:{number:!0}}),null,16,["disabled","modelValue"])])]),s("div",Ve,[s("div",Te,[t[58]||(t[58]=s("span",{class:"input-group-text",id:"inputGroup-sizing-sm"}," تخفیف ",-1)),a(f,m(e.currencyConfig,{"aria-label":"تخفیف روی فاکتور",class:"form-control",modelValue:e.data.discountAll,"onUpdate:modelValue":t[27]||(t[27]=o=>e.data.discountAll=o),modelModifiers:{number:!0}}),null,16,["modelValue"])])]),s("div",Ce,[s("div",we,[t[59]||(t[59]=s("span",{class:"input-group-text",id:"inputGroup-sizing-sm"}," حمل و نقل ",-1)),a(f,m(e.currencyConfig,{"aria-label":"مالیات بر ارزش افزوده",class:"form-control",modelValue:e.data.transferCost,"onUpdate:modelValue":t[28]||(t[28]=o=>e.data.transferCost=o),modelModifiers:{number:!0}}),null,16,["modelValue"])])])]),s("div",Pe,[s("a",$e,[s("div",Se,[s("div",Be,[s("div",Me,[t[60]||(t[60]=s("span",{class:"text-dark"},[s("i",{class:"fa fa-list-dots"}),l(" اقلام فاکتور: ")],-1)),s("span",Ne,d(e.items.length)+" قلم ",1)]),s("div",Ue,[t[61]||(t[61]=s("span",{class:"text-dark"},[s("i",{class:"fa fa-list-dots"}),l(" مالیات: ")],-1)),s("span",We,d(e.$filters.formatNumber(this.sumTax))+" "+d(e.$filters.getActiveMoney().shortName),1)]),s("div",Fe,[t[62]||(t[62]=s("span",{class:"text-dark"},[s("i",{class:"fa fa-list-check"}),l(" جمع مبلغ موارد انتخابی: ")],-1)),s("span",Ae,d(e.$filters.formatNumber(this.sumSelected))+" "+d(e.$filters.getActiveMoney().shortName),1)]),s("div",qe,[t[63]||(t[63]=s("span",{class:"text-dark"},[s("i",{class:"fa fa-list-dots"}),l(" جمع کل: ")],-1)),s("span",Ee,d(e.$filters.formatNumber(this.sumTotal))+" "+d(e.$filters.getActiveMoney().shortName),1)])])])])])])])]),_:1})]),_:1})]),_:1})]),_:1})],64)}const Qe=L(K,[["render",Le],["__scopeId","data-v-5688013a"]]);export{Qe as default};
